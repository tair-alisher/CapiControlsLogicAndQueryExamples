using CapiSample.CommonClasses;
using CapiSample.Form3.DataObjects;
using CapiSample.Interfaces;
using System;
using System.IO;

namespace CapiSample.Form3
{
    internal class FormThreeSectionTwoSupplySources : BaseControl<F3ProductAnswerData>, IControl
    {
        private const int supplySourcesAmount = 7;

        public FormThreeSectionTwoSupplySources(string connection) : base(connection) { }

        public void Execute()
        {
            CheckAnswers(base.CreateFile());
            Console.WriteLine("Раздел 2. Источники поступлений. Проверено.");
        }

        public void CheckAnswers(FileStream file)
        {
            var wrongAnswers = base.ExecuteQuery(answersWithInvalidValuesQuery);
            using (var writer = File.AppendText(file.Name))
            {
                foreach (var wrongAnswer in wrongAnswers)
                    base.WriteError(writer, wrongAnswer);
            }
            file.Close();
        }

        private string answersWithInvalidValuesQuery = @"with cte_all_products as (
	select unnest(array['1','6','7','8','11','13','15','18','20','22','24','26','29','31','33','35','37','40','42','44','46','48','51','53','55','57','59','62','64','66','68','70','73','75','77','79','81','84','86','88','90','92','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','137','138','139','140','141','142','143','144','145','146','149','150','151','152','154','155','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','201','202','203','204','205','206','207','208','209','210','211','212','213','214','215','216','217','218','219','220','221','222','223','224','225','226','227','228','229','230','231','232','233','234','235','426','432','437','439','440','441','442','443','444','448','449','450','451','452','453','454','455','487','488','489','490','491','501','502','503','504','505','506','507','508','509','510','511','512','513','514','515','516','532','533','534','535','536','537','538','539','540','541','542','543','544','545','546','561','562','563','564','565','568','569','570','572','573','574','575','576','577','578','579','580','581','582','583','584','585','586','587','588','589','590','591','592','601','602','603','604','605','606','607','608','609','640','641','642','651','652','654','655','657','658','659','660','661','662','663','664','665','666','667','668','681','682','683','684','685','686','687','688','689','690','691','692','131','132','133','134','135','136','147','148','153','427','428','429','430','431','433','434','435','436','438','445','446','447','456','457','475','476','477','478','479','480','481','482','483','484','485','486','566','567','571','621','623','622','624','625','626','627','628','629','630','631','632','633','634','635','636','637','531','638','639']) as code,
	unnest(array['мука пшеничная (Кг,гр)'/*1*/,'хлеб ржаной (Кг,гр)'/*6*/,'хлеб пшеничный белый, серый (Кг,гр)'/*7*/,'лепешки (Кг,гр)'/*8*/,'макароны (Кг,гр)'/*11*/,'вермишель (Кг,гр)'/*13*/,'лапша (Кг,гр)'/*15*/,'рожки (Кг,гр)'/*18*/,'лагман (Кг,гр)'/*20*/,'рис (Кг,гр)'/*22*/,'рисовая сечка (Кг,гр)'/*24*/,'крупа пшеничная (Кг,гр)'/*26*/,'манка (Кг,гр)'/*29*/,'овсянка (Кг,гр)'/*31*/,'гречка (Кг,гр)'/*33*/,'пшено (Кг,гр)'/*35*/,'ячневая  (Кг,гр)'/*37*/,'перловка (Кг,гр)'/*40*/,'талкан (Кг,гр)'/*42*/,'геркулес (зерна злаков)  (Кг,гр)'/*44*/,'крупа 5-7 злаков (Кг,гр)'/*46*/,'крупа ячменная (Кг,гр)'/*48*/,'крупа кукурузная (Кг,гр)'/*51*/,'горох (Кг,гр)'/*53*/,'фасоль (Кг,гр)'/*55*/,'маш (Кг,гр)'/*57*/,'чечевица сушеная(кг, гр)'/*59*/,'пирожное (Кг,гр)'/*62*/,'булочки (Кг,гр)'/*64*/,'торт (Кг,гр)'/*66*/,'пироги, пирожки, пончики (Кг,гр)'/*68*/,'пряники (Кг,гр)'/*70*/,'коржики, коврижки (Кг,гр)'/*73*/,'рулет (Кг,гр)'/*75*/,'печенье (Кг,гр)'/*77*/,'шоколадно вафельный торт (Кг,гр)'/*79*/,'вафли (Кг,гр)'/*81*/,'сладости восточные (чак-чак)(Кг,гр)'/*84*/,'сухари, кириешки (Кг,гр)'/*86*/,'кексы (Кг,гр)'/*88*/,'сушки, соломка, хлебные палочки (Кг,гр)'/*90*/,'бублики (Кг,гр)'/*92*/,'кукуруза (в початках) (Кг,гр.)'/*101*/,'картофель (Кг,гр.)'/*102*/,'морковь (Кг,гр.)'/*103*/,'свекла (Кг,гр.)'/*104*/,'редька, редис (Кг,гр.)'/*105*/,'репа (Кг,гр.)'/*106*/,'лук репчатый (Кг,гр.)'/*107*/,'лук зеленый (Кг,гр.)'/*108*/,'чеснок (Кг,гр.)'/*109*/,'помидоры (Кг,гр.)'/*110*/,'огурцы (Кг,гр.)'/*111*/,'зеленый горошек в стручках (Кг,гр.)'/*112*/,'зеленый фасоль в стручках  (Кг,гр.)'/*113*/,'цветная капуста (Кг,гр.)'/*114*/,'капуста белокочанная (Кг,гр.)'/*115*/,'грибы свежие (Кг,гр.)'/*116*/,'щавель (Кг,гр.)'/*117*/,'укроп (Кг,гр.)'/*118*/,'петрушка (Кг,гр.)'/*119*/,'прочая зелень (жондо, сельдерей, жусай, райхон) (Кг,гр.)'/*120*/,'тыква (Кг,гр.)'/*121*/,'кабачки (Кг,гр.)'/*122*/,'патиссоны (Кг,гр.)'/*123*/,'баклажаны (Кг,гр.)'/*124*/,'перец свежий ( болгарский, горький) (Кг,гр.)'/*125*/,'хрен (Кг,гр.)'/*126*/,'салат-латук (Кг,гр.)'/*127*/,'салаты корейские (Кг,гр.)'/*137*/,'горошек консервированный (Кг,гр.)'/*138*/,'фасоль консервированная (Кг,гр.)'/*139*/,'маслины и оливки консервированные (Кг,гр.)'/*140*/,'кукуруза консервированная (Кг,гр.)'/*141*/,'капуста квашеная (Кг,гр.)'/*142*/,'огурцы соленые (Кг,гр.)'/*143*/,'помидоры соленые (Кг,гр.)'/*144*/,'перец соленый (Кг,гр.)'/*145*/,'жондо, жусай, соленые (Кг,гр.)'/*146*/,'грибы сушенные (Кг,гр.)'/*149*/,'грибы соленные  (Кг,гр.)'/*150*/,'овощи и грибы сушеные (Кг,гр.)'/*151*/,'ананасы консервированные (Кг,гр.)'/*152*/,'повидло, джем, варенье (Кг,гр.)'/*154*/,'спаржа (Кг,гр)'/*155*/,'абрикос (Кг,гр.)'/*161*/,'айва (Кг,гр.)'/*162*/,'алыча (Кг,гр.)'/*163*/,'ананас (Кг,гр.)'/*164*/,'апельсин (Кг,гр.)'/*165*/,'арбуз (Кг,гр.)'/*166*/,'банан (Кг,гр.)'/*167*/,'барбарис (Кг,гр.)'/*168*/,'виноград (Кг,гр.)'/*169*/,'вишня, черешня (Кг,гр.)'/*170*/,'гранат (Кг,гр.)'/*171*/,'грейпфруты (Кг,гр.)'/*172*/,'груши (Кг,гр.)'/*173*/,'дыня (Кг,гр.)'/*174*/,'киви, манго, папайя (Кг,гр.)'/*175*/,'клубника (Кг,гр.)'/*176*/,'крыжовник (Кг,гр.)'/*177*/,'лимон (Кг,гр.)'/*178*/,'малина (Кг,гр.)'/*179*/,'мандарин (Кг,гр.)'/*180*/,'облепиха (Кг,гр.)'/*181*/,'персик (Кг,гр.)'/*182*/,'слива (Кг,гр.)'/*183*/,'смородина (Кг,гр.)'/*184*/,'урюк (Кг,гр.)'/*185*/,'хурма (Кг,гр.)'/*186*/,'яблоки (Кг,гр.)'/*187*/,'жир свиной, сало (Кг,гр.)'/*201*/,'жир скота (бараний, говяжий, овец, коз) (Кг,гр.)'/*202*/,'карта, чучук, казы (Кг,гр)'/*203*/,'колбаса варенная ( докторская, чайная,  (Кг,гр)'/*204*/,'колбаса варенная (сосиски, сардельки) (Кг,гр)'/*205*/,'колбаса копченная  (Кг,гр)'/*206*/,'колбаса ливерная, кровяная, печеночная (Кг,гр)'/*207*/,'копченные окорочка (Кг,гр)'/*208*/,'гриль (Кг,гр)'/*209*/,'копчености мясные  из говядины (Кг,гр)'/*210*/,'копчености мясные  из свинины (Кг,гр)'/*211*/,'копчености мясные из баранины (Кг,гр)'/*212*/,'копчености мясные из конины (Кг,гр)'/*213*/,'сырокопченая колбаса (Кг,гр)'/*214*/,'куры, цыплята (Кг,гр.)'/*215*/,'мясо говядина  (Кг,гр.)'/*216*/,'мясо баранина (Кг,гр.)'/*217*/,'мясо свинина (Кг,гр.)'/*218*/,'мясо козлятина (Кг,гр.)'/*219*/,'мясо конина (Кг,гр.)'/*220*/,'мясо индейки (Кг,гр.)'/*221*/,'мясо уток, гусей (Кг,гр.)'/*222*/,'мясо кролика (Кг,гр.)'/*223*/,'мясо нутрий (Кг,гр.)'/*224*/,'окорочка куринные (Кг,гр.)'/*225*/,'соевое мясо, соевый сыр и фарш (Кг,гр)'/*226*/,'субпродукты 1 категории  (головное мясо, хвост, мясная обрез) (Кг,гр)'/*227*/,'субпродукты 1 категории  (диафрагма, печень говяжья, баранья, свиная) (Кг,гр)'/*228*/,'субпродукты 1 категории  (сердце, язык, почки, вымя, мозги) (Кг,гр)'/*229*/,'субпродукты 2 категории (легкие, селезенка, желудок, кишки) (Кг,гр)'/*230*/,'субпродукты 2 категории (уши, губы, ножки) (Кг,гр)'/*231*/,'субпродукты птиц (Кг,гр.)'/*232*/,'тушенка (консервы) (Кг,гр)'/*233*/,'фарш (Кг,гр)'/*234*/,'холодец (Кг,гр)'/*235*/,'мороженное (Кг,гр.)'/*426*/,'сгущенка (Кг,гр)'/*432*/,'суюзмо (Кг,гр)'/*437*/,'сухое молоко, сухие сливки (Кг,гр)'/*439*/,'сырки творожные нежирные (Кг,гр)'/*440*/,'сырки творожные в шоколаде, рыжий ап (Кг,гр)'/*441*/,'йогурт, фругурт (Кг,гр)'/*442*/,'творог нежирный (Кг,гр)'/*443*/,'творог жирный (Кг,гр)'/*444*/,'курут (Кг,гр)'/*448*/,'сыр твердые (голландский, российский тильзитский) (Кг,гр)'/*449*/,'сыр мягкий (адыгейский, сулугуни) (Кг,гр)'/*450*/,'сыры рассольные (брынза) (Кг,гр)'/*451*/,'сыр колбасный (Кг,гр)'/*452*/,'сыр плавленый и с наполнителями (Кг,гр)'/*453*/,'детское питание (на молочной основе) (Кг,гр)'/*454*/,'детское питание в виде смесей на гречневых, рисовых, овсяных отварах (Кг,гр)'/*455*/,'маргарин (Кг,гр)'/*487*/,'маргарин (рама, щедрое лето, иртыш) (Кг,гр)'/*488*/,'масло сливочное (Кг,гр)'/*489*/,'масло шоколадное (Кг,гр)'/*490*/,'масло топленное (Кг,гр)'/*491*/,'сахар (песок, рафинад) (Кг,гр)'/*501*/,'сахар для диабетиков (Кг,гр)'/*502*/,'шоколад плиточный (Кг,гр)'/*503*/,'батончики шоколадные  (сникерс, марс) (Кг,гр)'/*504*/,'конфеты шоколадные (Кг,гр)'/*505*/,'конфеты карамель с начинкой (Кг,гр)'/*506*/,'леденцы (Кг,гр)'/*507*/,'ирис (Кг,гр)'/*508*/,'халва (Кг,гр)'/*509*/,'пастила, зефир (Кг,гр)'/*510*/,'мармелад (Кг,гр)'/*511*/,'нават (сладости восточные) (Кг,гр)'/*512*/,'мед натуральный (Кг,гр)'/*513*/,'мед искусственный (Кг,гр)'/*514*/,'сиропы разные (Кг,гр)'/*515*/,'шоколадная паста (Кг,гр)'/*516*/,'рыба свежая (Кг,гр.)'/*532*/,'рыба копченая (Кг,гр.)'/*533*/,'вяленная рыба (Кг,гр.)'/*534*/,'сельдь соленая (Кг,гр.)'/*535*/,'сельдь в банках (Кг,гр.)'/*536*/,'сельдь копченная (Кг,гр.)'/*537*/,'рыбные консервы в масле (Кг,гр.)'/*538*/,'рыбные консервы в томатном соусе (Кг,гр.)'/*539*/,'рыбные консервы в собственном соку (Кг,гр.)'/*540*/,'паштет рыбный (Кг,гр.)'/*541*/,'присервы рыбные (Кг,гр.)'/*542*/,'икра осетровых рыб (Кг,гр.)'/*543*/,'икра рыбная (Кг,гр.)'/*544*/,'крабовые палочки (Кг,гр.)'/*545*/,'морская капуста (Кг,гр.)'/*546*/,'какао порошок (Кг,гр.)'/*561*/,'кофе в зернах (Кг,гр.)'/*562*/,'кофе растворимый (Кг,гр.)'/*563*/,'чай черный (Кг,гр.)'/*564*/,'чай зеленый (Кг,гр.)'/*565*/,'горчица (Кг,гр.)'/*568*/,'майонез (Кг,гр.)'/*569*/,'томатная паста     (Кг,гр.)'/*570*/,'перец черный, красный молотый (Кг,гр.)'/*572*/,'черный перец горошком (Кг,гр.)'/*573*/,'приправы сухие (кинза, зире, кристаллики)(Кг,гр.)'/*574*/,'бульонные кубики, порошок (Ролтон, Маги) (Кг,гр.)'/*575*/,'ванилин (Кг,гр.)'/*576*/,'корица (Кг,гр.)'/*577*/,'гвоздика (Кг,гр.)'/*578*/,'лавровый лист (Кг,гр.)'/*579*/,'мак (Кг,гр.)'/*580*/,'соль (Кг,гр)'/*581*/,'соль морская (Кг,гр)'/*582*/,'разрыхлитель теста (Кг,гр.)'/*583*/,'сода пищевая (Кг,гр.)'/*584*/,'лимонная кислота (Кг,гр.)'/*585*/,'дрожжи сухие (Кг,гр.)'/*586*/,'дрожжи сырые (Кг,гр.)'/*587*/,'кокосовая стружка (Кг,гр.)'/*588*/,'желатин (Кг,гр.)'/*589*/,'соевый соус (Кг,гр.)'/*590*/,'имбирь (Кг,гр.)'/*591*/,'кисель, инвайт (Кг,гр.)'/*592*/,'пельмени (Кг,гр)'/*601*/,'вареники (Кг,гр)'/*602*/,'кукси (Кг,гр)'/*603*/,'тесто недрожжевое (Кг,гр)'/*604*/,'фунчеза (изделия макаронные не включенные в другие группы) (Кг,гр)'/*605*/,'смеси и тесто для приготовления хлебобулочных изделий (Кг,гр)'/*606*/,'картофельные чипсы (Кг,гр)'/*607*/,'палочки кукурузные, попкорн (Кг,гр)'/*608*/,'сухие завтраки (хлопья, колечки) (Кг,гр)'/*609*/,'махорка (Кг,гр)'/*640*/,'табак курительный (Кг,гр)'/*641*/,'насвай (Кг,гр)'/*642*/,'бобы соевые (Кг,гр)'/*651*/,'миндаль (Кг,гр.)'/*652*/,'фундук (Кг,гр.)'/*654*/,'фисташки (Кг,гр.)'/*655*/,'орех мускатный (Кг,гр.)'/*657*/,'арахис обжаренный (соленный, обработанный) (Кг,гр.)'/*658*/,'орехи обработанные (орех лесной, грецкие орехи) (Кг,гр.)'/*659*/,'виноград сушенный (изюм) (Кг,гр.)'/*660*/,'фрукты сушеные прочие (Кг,гр.)'/*661*/,'чернослив (Кг,гр.)'/*662*/,'яблоки и груши (Кг,гр.)'/*663*/,'смеси сухофруктов (Кг,гр.)'/*664*/,'абрикос (курага) (Кг,гр.)'/*665*/,'косточки и ядра абрикосов, персиков и слив (Кг,гр.)'/*666*/,'финики (Кг,гр.)'/*667*/,'цукаты, фрукты засахаренные, пропитанные сиропом и осушенные (Кг,гр.)'/*668*/,'семена хлопка (для переработки на масло) (Кг,гр)'/*681*/,'семена подсолнечника (Кг,гр.)'/*682*/,'крахмал пшеничный (Кг,гр)'/*683*/,'крахмал  кукурузный (Кг,гр)'/*684*/,'крахмал картофельный (Кг,гр)'/*685*/,'сумолок (Кг,гр)'/*686*/,'жевательная резинка (Кг,гр)'/*687*/,'краска для яиц пищевая, яичный порошок (Кг,гр)'/*688*/,'корм для декоративных птиц (Кг,гр)'/*689*/,'корм собакам (Кг,гр)'/*690*/,'корм кошкам (Кг,гр)'/*691*/,'гематоген (Кг,гр)'/*692*/,'салаты консервированные (Л,мл.)'/*131*/,'салаты консервированные с уксусом (л,мл)'/*132*/,'огурцы маринованные (Л,мл.)'/*133*/,'помидоры маринованные (Л,мл.)'/*134*/,'грибы маринованные (Л,мл.)'/*135*/,'ассорти овощное консервированное (Л,мл.)'/*136*/,'овощи (патиссоны, кабачки) и салаты, маринованные (Л,мл.)'/*147*/,'кабачки маринованные (Л,мл.)'/*148*/,'фруктовые компоты (консервированные) (Л,мл.)'/*153*/,'молоко домашнее коровье (Л,мл.)'/*427*/,'молоко пастеризованное (Л,мл.)'/*428*/,'молоко домашнее козье (Л,мл.)'/*429*/,'молоко топленое (Л,мл.)'/*430*/,'сливки жидкие (Л,мл.)'/*431*/,'айран, простокваша (Л,мл.)'/*433*/,'кефир (Л,мл.)'/*434*/,'сметана (Л,мл.)'/*435*/,'ряженка (Л,мл.)'/*436*/,'биолакт (Л,мл.)'/*438*/,'сыворотка (Л,мл.)'/*445*/,'обрат (Л,мл.)'/*446*/,'пахта (Л,мл.)'/*447*/,'кумыс (Л,мл.)'/*456*/,'тан, той-бос (Л,мл.)'/*457*/,'соевое масло нерафинированное (Л,мл)'/*475*/,'оливковое масло нерафинированные (Л,мл)'/*476*/,'подсолнечное и сафлоровое масло нерафинированное (Л,мл)'/*477*/,'хлопковое масло нерафинированное (Л,мл)'/*478*/,'рапсовое, сурепное  и горчичное нерафинированное (Л,мл)'/*479*/,'кукурузное масло нерафинированное (Л,мл)'/*480*/,'рафинированное соевое масло (Л,мл)'/*481*/,'рафинированное оливковое масло (Л,мл)'/*482*/,'рафинированное подсолнечное и сафлоровое масло  (Л,мл)'/*483*/,'рафинированное хлопковое масло (Л,мл)'/*484*/,'рафинированное рапсовое, сурепное и горчичное масло (Л,мл)'/*485*/,'рафинированное кукурузное масло (Л,мл)'/*486*/,'уксус (Л,мл.)'/*566*/,'кетчуп (Л,мл.)'/*567*/,'аджика (сухой томат) (Л,мл.)'/*571*/,'сок овощной (Л,мл.)'/*621*/,'сок фруктовый (Л,мл.)'/*622*/,'соки ассорти(искусственные)(л мл)'/*623*/,'коньяк (Л,мл.)'/*624*/,'водка (Л,мл.)'/*625*/,'спирт (Л,мл.)'/*626*/,'бальзам (Л,мл.)'/*627*/,'самогон (Л,мл.)'/*628*/,'шампанское (Л,мл.)'/*629*/,'вино заводское, виноградные натуральные вина (Л,мл.)'/*630*/,'вино домашнее, сидр прочие фруктовые вина (Л,мл.)'/*631*/,'бозо (Л,мл.)'/*632*/,'пиво (Л,мл.)'/*633*/,'минеральная вода (Л,мл.)'/*634*/,'лимонад, кола, фанта (Л,мл.)'/*635*/,'квас (Л,мл.)'/*636*/,'максым-шоро, жарма (Л,мл.)'/*637*/,'яйца (Шт)'/*531*/,'сигареты с фильтром (Шт)'/*638*/,'папиросы (Шт)'/*639*/]) as title
),

cte_valid_products_lph as (
    select unnest(array['169','186','171','178','215','221','101','113','112','55','53','57','59','115','114','127','119','118','117','120','166','174','125','111','124','110','121','122','123','103','106','109','107','108','104','105','126','102','116','187','173','161','162','161','170','182','163','168','179','176','177','184','427','429','531','513','216','218','217','219','220','227','223','224','201','202','230','183','185','181','232','222','681','682','456','22','641','228','231','229']) as code,
    unnest(array['виноград (Кг,гр.)'/*169*/,'хурма (Кг,гр.)'/*186*/,'гранат (Кг,гр.)'/*171*/,'лимон (Кг,гр.)'/*178*/,'куры, цыплята (Кг,гр.)'/*215*/,'мясо индейки (Кг,гр.)'/*221*/,'кукуруза (в початках) (Кг,гр.)'/*101*/,'зеленый фасоль в стручках  (Кг,гр.)'/*113*/,'зеленый горошек в стручках (Кг,гр.)'/*112*/,'фасоль (Кг,гр)'/*55*/,'горох (Кг,гр)'/*53*/,'маш (Кг,гр)'/*57*/,'чечевица сушеная (Кг, гр)'/*59*/,'капуста белокочанная (Кг,гр.)'/*115*/,'цветная капуста (Кг,гр.)'/*114*/,'салат-латук (Кг,гр.)'/*127*/,'петрушка (Кг,гр.)'/*119*/,'укроп (Кг,гр.)'/*118*/,'щавель (Кг,гр.)'/*117*/,'прочая зелень (жондо, сельдерей, жусай, райхон) (Кг,гр.)'/*120*/,'арбуз (Кг,гр.)'/*166*/,'дыня (Кг,гр.)'/*174*/,'перец свежий ( болгарский, горький) (Кг,гр.)'/*125*/,'огурцы (Кг,гр.)'/*111*/,'баклажаны (Кг,гр.)'/*124*/,'помидоры (Кг,гр.)'/*110*/,'тыква (Кг,гр.)'/*121*/,'кабачки (Кг,гр.)'/*122*/,'патиссоны (Кг,гр.)'/*123*/,'морковь (Кг,гр.)'/*103*/,'репа (Кг,гр.)'/*106*/,'чеснок (Кг,гр.)'/*109*/,'лук репчатый (Кг,гр.)'/*107*/,'лук зеленый (Кг,гр.)'/*108*/,'свекла (Кг,гр.)'/*104*/,'редька, редис (Кг,гр.)'/*105*/,'хрен (Кг,гр.)'/*126*/,'картофель (Кг,гр.)'/*102*/,'грибы свежие (Кг,гр.)'/*116*/,'яблоки (Кг,гр.)'/*187*/,'груши (Кг,гр.)'/*173*/,'абрикос (Кг,гр.)'/*161*/,'айва (Кг,гр.)'/*162*/,'абрикос (Кг,гр.)'/*161*/,'вишня, черешня (Кг,гр.)'/*170*/,'персик (Кг,гр.)'/*182*/,'алыча (Кг,гр.)'/*163*/,'барбарис (Кг,гр.)'/*168*/,'малина (Кг,гр.)'/*179*/,'клубника (Кг,гр.)'/*176*/,'крыжовник (Кг,гр.)'/*177*/,'смородина (Кг,гр.)'/*184*/,'молоко домашнее коровье (Л,мл.)'/*427*/,'молоко домашнее козье (Л,мл.)'/*429*/,'яйца (Шт)'/*531*/,'мед натуральный (Кг,гр)'/*513*/,'мясо говядина  (Кг,гр.)'/*216*/,'мясо свинина (Кг,гр.)'/*218*/,'мясо баранина (Кг,гр.)'/*217*/,'мясо козлятина (Кг,гр.)'/*219*/,'мясо конина (Кг,гр.)'/*220*/,'субпродукты 1 категории  (головное мясо, хвост, мясная обрез) (Кг,гр)'/*227*/,'мясо кролика (Кг,гр.)'/*223*/,'мясо нутрий (Кг,гр.)'/*224*/,'жир свиной, сало (Кг,гр.)'/*201*/,'жир скота (бараний, говяжий, овец, коз) (Кг,гр.)'/*202*/,'субпродукты 2 категории (легкие, селезенка, желудок, кишки) (Кг,гр)'/*230*/,'слива (Кг,гр.)'/*183*/,'урюк (Кг,гр.)'/*185*/,'облепиха (Кг,гр.)'/*181*/,'субпродукты птиц (Кг,гр.)'/*232*/,'мясо уток, гусей (Кг,гр.)'/*222*/,'семена хлопка (для переработки на масло) (Кг,гр)'/*681*/,'семена подсолнечника (Кг,гр.)'/*682*/,'кумыс (Л,мл.)'/*456*/,'рис (Кг,гр)'/*22*/,'табак курительный (Кг,гр)'/*641*/,'субпродукты 1 категории  (диафрагма, печень говяжья, баранья, свиная) (Кг,гр)'/*228*/,'субпродукты 2 категории (уши, губы, ножки) (Кг,гр)'/*231*/,'субпродукты 1 категории  (сердце, язык, почки, вымя, мозги) (Кг,гр)'/*229*/]) as title
),

cte_valid_products_kuplen as (
    select unnest(array['169','186','171','178','215','221','101','113','112','205','55','59','53','57','115','114','127','119','118','117','120','166','174','125','111','124','110','121','122','123','103','106','109','107','108','104','105','126','102','116','187','173','161','162','161','170','182','163','168','179','176','177','184','427','429','531','513','216','218','217','219','220','227','223','224','201','202','230','580','175','573','582','627','225','536','540','539','538','153','428','430','439','440','441','609','79','90','92','561','504','505','687','508','507','506','634','639','638','692','167','172','164','165','180','487','488','562','563','565','564','566','577','576','578','579','591','574','581','454','455','575','586','587','583','515','226','689','690','691','624','625','626','629','630','633','584','585','589','183','185','181','232','222','546','590','567','568','569','571','572','515','515','628','211','210','213','212','208','207','204','204','206','214','203','235','209','234','233','534','535','537','533','541','542','543','544','545','607','621','622','623','131','143','151','149','155','139','138','144','570','150','142','140','141','137','137','137','132','133','134','136','147','135','154','651','652','658','654','655','657','659','152','660','661','665','662','663','664','666','588','153','475','476','477','478','479','481','482','483','484','485','446','431','489','490','491','437','443','444','449','450','451','453','452','432','433','434','436','435','438','448','442','447','445','457','426','24','1','606','26','29','31','51','33','35','37','40','48','42','44','46','608','683','684','685','686','514','480','486','6','7','8','62','66','68','64','84','86','70','73','88','75','77','81','11','13','15','18','20','501','503','516','510','511','509','512','667','667','604','601','602','603','605','631','632','635','636','637','640','642','134','502','681','682','456','22','641','532','205','228','231','229','592']) as code,
    unnest(array['виноград (Кг,гр.)'/*169*/,'хурма (Кг,гр.)'/*186*/,'гранат (Кг,гр.)'/*171*/,'лимон (Кг,гр.)'/*178*/,'куры, цыплята (Кг,гр.)'/*215*/,'мясо индейки (Кг,гр.)'/*221*/,'кукуруза (в початках) (Кг,гр.)'/*101*/,'зеленый фасоль в стручках  (Кг,гр.)'/*113*/,'зеленый горошек в стручках (Кг,гр.)'/*112*/,'колбаса варенная (сосиски, сардельки) (Кг,гр)'/*205*/,'фасоль (Кг,гр)'/*55*/,'чечевица сушеная (Кг, гр)'/*59*/,'горох (Кг,гр)'/*53*/,'маш (Кг,гр)'/*57*/,'капуста белокочанная (Кг,гр.)'/*115*/,'цветная капуста (Кг,гр.)'/*114*/,'салат-латук (Кг,гр.)'/*127*/,'петрушка (Кг,гр.)'/*119*/,'укроп (Кг,гр.)'/*118*/,'щавель (Кг,гр.)'/*117*/,'прочая зелень (жондо, сельдерей, жусай, райхон) (Кг,гр.)'/*120*/,'арбуз (Кг,гр.)'/*166*/,'дыня (Кг,гр.)'/*174*/,'перец свежий ( болгарский, горький) (Кг,гр.)'/*125*/,'огурцы (Кг,гр.)'/*111*/,'баклажаны (Кг,гр.)'/*124*/,'помидоры (Кг,гр.)'/*110*/,'тыква (Кг,гр.)'/*121*/,'кабачки (Кг,гр.)'/*122*/,'патиссоны (Кг,гр.)'/*123*/,'морковь (Кг,гр.)'/*103*/,'репа (Кг,гр.)'/*106*/,'чеснок (Кг,гр.)'/*109*/,'лук репчатый (Кг,гр.)'/*107*/,'лук зеленый (Кг,гр.)'/*108*/,'свекла (Кг,гр.)'/*104*/,'редька, редис (Кг,гр.)'/*105*/,'хрен (Кг,гр.)'/*126*/,'картофель (Кг,гр.)'/*102*/,'грибы свежие (Кг,гр.)'/*116*/,'яблоки (Кг,гр.)'/*187*/,'груши (Кг,гр.)'/*173*/,'абрикос (Кг,гр.)'/*161*/,'айва (Кг,гр.)'/*162*/,'абрикос (Кг,гр.)'/*161*/,'вишня, черешня (Кг,гр.)'/*170*/,'персик (Кг,гр.)'/*182*/,'алыча (Кг,гр.)'/*163*/,'барбарис (Кг,гр.)'/*168*/,'малина (Кг,гр.)'/*179*/,'клубника (Кг,гр.)'/*176*/,'крыжовник (Кг,гр.)'/*177*/,'смородина (Кг,гр.)'/*184*/,'молоко домашнее коровье (Л,мл.)'/*427*/,'молоко домашнее козье (Л,мл.)'/*429*/,'яйца (Шт)'/*531*/,'мед натуральный (Кг,гр)'/*513*/,'мясо говядина  (Кг,гр.)'/*216*/,'мясо свинина (Кг,гр.)'/*218*/,'мясо баранина (Кг,гр.)'/*217*/,'мясо козлятина (Кг,гр.)'/*219*/,'мясо конина (Кг,гр.)'/*220*/,'субпродукты 1 категории  (головное мясо, хвост, мясная обрез) (Кг,гр)'/*227*/,'мясо кролика (Кг,гр.)'/*223*/,'мясо нутрий (Кг,гр.)'/*224*/,'жир свиной, сало (Кг,гр.)'/*201*/,'жир скота (бараний, говяжий, овец, коз) (Кг,гр.)'/*202*/,'субпродукты 2 категории (легкие, селезенка, желудок, кишки) (Кг,гр)'/*230*/,'мак (Кг,гр.)'/*580*/,'киви, манго, папайя (Кг,гр.)'/*175*/,'черный перец горошком (Кг,гр.)'/*573*/,'соль морская (Кг,гр)'/*582*/,'бальзам (Л,мл.)'/*627*/,'окорочка куринные (Кг,гр.)'/*225*/,'сельдь в банках (Кг,гр.)'/*536*/,'рыбные консервы в собственном соку (Кг,гр.)'/*540*/,'рыбные консервы в томатном соусе (Кг,гр.)'/*539*/,'рыбные консервы в масле (Кг,гр.)'/*538*/,'фруктовые компоты (консервированные) (Л,мл.)'/*153*/,'молоко пастеризованное (Л,мл.)'/*428*/,'молоко топленое (Л,мл.)'/*430*/,'сухое молоко, сухие сливки (Кг,гр)'/*439*/,'сырки творожные нежирные (Кг,гр)'/*440*/,'сырки творожные в шоколаде, рыжий ап (Кг,гр)'/*441*/,'сухие завтраки (хлопья, колечки) (Кг,гр)'/*609*/,'шоколадно вафельный торт (Кг,гр)'/*79*/,'сушки, соломка, хлебные палочки (Кг,гр)'/*90*/,'бублики (Кг,гр)'/*92*/,'какао порошок (Кг,гр.)'/*561*/,'батончики шоколадные  (сникерс, марс) (Кг,гр)'/*504*/,'конфеты шоколадные (Кг,гр)'/*505*/,'жевательная резинка (Кг,гр)'/*687*/,'ирис (Кг,гр)'/*508*/,'леденцы (Кг,гр)'/*507*/,'конфеты карамель с начинкой (Кг,гр)'/*506*/,'минеральная вода (Л,мл.)'/*634*/,'папиросы (Шт)'/*639*/,'сигареты с фильтром (Шт)'/*638*/,'гематоген (Кг,гр)'/*692*/,'банан (Кг,гр.)'/*167*/,'грейпфруты (Кг,гр.)'/*172*/,'ананас (Кг,гр.)'/*164*/,'апельсин (Кг,гр.)'/*165*/,'мандарин (Кг,гр.)'/*180*/,'маргарин (Кг,гр)'/*487*/,'маргарин (рама, щедрое лето, иртыш) (Кг,гр)'/*488*/,'кофе в зернах (Кг,гр.)'/*562*/,'кофе растворимый (Кг,гр.)'/*563*/,'чай зеленый (Кг,гр.)'/*565*/,'чай черный (Кг,гр.)'/*564*/,'уксус (Л,мл.)'/*566*/,'корица (Кг,гр.)'/*577*/,'ванилин (Кг,гр.)'/*576*/,'гвоздика (Кг,гр.)'/*578*/,'лавровый лист (Кг,гр.)'/*579*/,'имбирь (Кг,гр.)'/*591*/,'приправы сухие (кинза, зире, кристаллики)(Кг,гр.)'/*574*/,'соль (Кг,гр)'/*581*/,'детское питание (на молочной основе) (Кг,гр)'/*454*/,'детское питание в виде смесей на гречневых, рисовых, овсяных отварах (Кг,гр)'/*455*/,'бульонные кубики, порошок (Ролтон, Маги) (Кг,гр.)'/*575*/,'дрожжи сухие (Кг,гр.)'/*586*/,'дрожжи сырые (Кг,гр.)'/*587*/,'разрыхлитель теста (Кг,гр.)'/*583*/,'сиропы разные (Кг,гр)'/*515*/,'соевое мясо, соевый сыр и фарш (Кг,гр)'/*226*/,'корм для декоративных птиц (Кг,гр)'/*689*/,'корм собакам (Кг,гр)'/*690*/,'корм кошкам (Кг,гр)'/*691*/,'коньяк (Л,мл.)'/*624*/,'водка (Л,мл.)'/*625*/,'спирт (Л,мл.)'/*626*/,'шампанское (Л,мл.)'/*629*/,'вино заводское, виноградные натуральные вина (Л,мл.)'/*630*/,'пиво (Л,мл.)'/*633*/,'сода пищевая (Кг,гр.)'/*584*/,'лимонная кислота (Кг,гр.)'/*585*/,'желатин (Кг,гр.)'/*589*/,'слива (Кг,гр.)'/*183*/,'урюк (Кг,гр.)'/*185*/,'облепиха (Кг,гр.)'/*181*/,'субпродукты птиц (Кг,гр.)'/*232*/,'мясо уток, гусей (Кг,гр.)'/*222*/,'морская капуста (Кг,гр.)'/*546*/,'соевый соус (Кг,гр.)'/*590*/,'кетчуп (Л,мл.)'/*567*/,'горчица (Кг,гр.)'/*568*/,'майонез (Кг,гр.)'/*569*/,'аджика (сухой томат) (Л,мл.)'/*571*/,'перец черный, красный молотый (Кг,гр.)'/*572*/,'сиропы разные (Кг,гр)'/*515*/,'сиропы разные (Кг,гр)'/*515*/,'самогон (Л,мл.)'/*628*/,'копчености мясные  из свинины (Кг,гр)'/*211*/,'копчености мясные  из говядины (Кг,гр)'/*210*/,'копчености мясные из конины (Кг,гр)'/*213*/,'копчености мясные из баранины (Кг,гр)'/*212*/,'копченные окорочка (Кг,гр)'/*208*/,'колбаса ливерная, кровяная, печеночная (Кг,гр)'/*207*/,'колбаса варенная ( докторская, чайная,  (Кг,гр)'/*204*/,'колбаса варенная ( докторская, чайная,  (Кг,гр)'/*204*/,'колбаса копченная  (Кг,гр)'/*206*/,'сырокопченая колбаса (Кг,гр)'/*214*/,'карта, чучук, казы (Кг,гр)'/*203*/,'холодец (Кг,гр)'/*235*/,'гриль (Кг,гр)'/*209*/,'фарш (Кг,гр)'/*234*/,'тушенка (консервы) (Кг,гр)'/*233*/,'вяленная рыба (Кг,гр.)'/*534*/,'сельдь соленая (Кг,гр.)'/*535*/,'сельдь копченная (Кг,гр.)'/*537*/,'рыба копченая (Кг,гр.)'/*533*/,'паштет рыбный (Кг,гр.)'/*541*/,'присервы рыбные (Кг,гр.)'/*542*/,'икра осетровых рыб (Кг,гр.)'/*543*/,'икра рыбная (Кг,гр.)'/*544*/,'крабовые палочки (Кг,гр.)'/*545*/,'картофельные чипсы (Кг,гр)'/*607*/,'сок овощной (Л,мл.)'/*621*/,'сок фруктовый (Л,мл.)'/*622*/,'соки ассорти(искусственные)(л мл)'/*623*/,'салаты консервированные (Л,мл.)'/*131*/,'огурцы соленые (Кг,гр.)'/*143*/,'овощи и грибы сушеные (Кг,гр.)'/*151*/,'грибы сушенные (Кг,гр.)'/*149*/,'спаржа (Кг,гр)'/*155*/,'фасоль консервированная (Кг,гр.)'/*139*/,'горошек консервированный (Кг,гр.)'/*138*/,'помидоры соленые (Кг,гр.)'/*144*/,'томатная паста     (Кг,гр.)'/*570*/,'грибы соленные  (Кг,гр.)'/*150*/,'капуста квашеная (Кг,гр.)'/*142*/,'маслины и оливки консервированные (Кг,гр.)'/*140*/,'кукуруза консервированная (Кг,гр.)'/*141*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты консервированные с уксусом (л,мл)'/*132*/,'огурцы маринованные (Л,мл.)'/*133*/,'помидоры маринованные (Л,мл.)'/*134*/,'ассорти овощное консервированное (Л,мл.)'/*136*/,'овощи (патиссоны, кабачки) и салаты, маринованные (Л,мл.)'/*147*/,'грибы маринованные (Л,мл.)'/*135*/,'повидло, джем, варенье (Кг,гр.)'/*154*/,'бобы соевые (Кг,гр)'/*651*/,'миндаль (Кг,гр.)'/*652*/,'арахис обжаренный (соленный, обработанный) (Кг,гр.)'/*658*/,'фундук (Кг,гр.)'/*654*/,'фисташки (Кг,гр.)'/*655*/,'орех мускатный (Кг,гр.)'/*657*/,'орехи обработанные (орех лесной, грецкие орехи) (Кг,гр.)'/*659*/,'ананасы консервированные (Кг,гр.)'/*152*/,'виноград сушенный (изюм) (Кг,гр.)'/*660*/,'фрукты сушеные прочие (Кг,гр.)'/*661*/,'абрикос (курага) (Кг,гр.)'/*665*/,'чернослив (Кг,гр.)'/*662*/,'яблоки и груши (Кг,гр.)'/*663*/,'смеси сухофруктов (Кг,гр.)'/*664*/,'косточки и ядра абрикосов, персиков и слив (Кг,гр.)'/*666*/,'кокосовая стружка (Кг,гр.)'/*588*/,'фруктовые компоты (консервированные) (Л,мл.)'/*153*/,'соевое масло нерафинированное (Л,мл)'/*475*/,'оливковое масло нерафинированные (Л,мл)'/*476*/,'подсолнечное и сафлоровое масло нерафинированное (Л,мл)'/*477*/,'хлопковое масло нерафинированное (Л,мл)'/*478*/,'рапсовое, сурепное  и горчичное нерафинированное (Л,мл)'/*479*/,'рафинированное соевое масло (Л,мл)'/*481*/,'рафинированное оливковое масло (Л,мл)'/*482*/,'рафинированное подсолнечное и сафлоровое масло  (Л,мл)'/*483*/,'рафинированное хлопковое масло (Л,мл)'/*484*/,'рафинированное рапсовое, сурепное и горчичное масло (Л,мл)'/*485*/,'обрат (Л,мл.)'/*446*/,'сливки жидкие (Л,мл.)'/*431*/,'масло сливочное (Кг,гр)'/*489*/,'масло шоколадное (Кг,гр)'/*490*/,'масло топленное (Кг,гр)'/*491*/,'суюзмо (Кг,гр)'/*437*/,'творог нежирный (Кг,гр)'/*443*/,'творог жирный (Кг,гр)'/*444*/,'сыр твердые (голландский, российский тильзитский) (Кг,гр)'/*449*/,'сыр мягкий (адыгейский, сулугуни) (Кг,гр)'/*450*/,'сыры рассольные (брынза) (Кг,гр)'/*451*/,'сыр плавленый и с наполнителями (Кг,гр)'/*453*/,'сыр колбасный (Кг,гр)'/*452*/,'сгущенка (Кг,гр)'/*432*/,'айран, простокваша (Л,мл.)'/*433*/,'кефир (Л,мл.)'/*434*/,'ряженка (Л,мл.)'/*436*/,'сметана (Л,мл.)'/*435*/,'биолакт (Л,мл.)'/*438*/,'курут (Кг,гр)'/*448*/,'йогурт, фругурт (Кг,гр)'/*442*/,'пахта (Л,мл.)'/*447*/,'сыворотка (Л,мл.)'/*445*/,'тан, той-бос (Л,мл.)'/*457*/,'мороженное (Кг,гр.)'/*426*/,'рисовая сечка (Кг,гр)'/*24*/,'мука пшеничная (Кг,гр)'/*1*/,'смеси и тесто для приготовления хлебобулочных изделий (Кг,гр)'/*606*/,'крупа пшеничная (Кг,гр)'/*26*/,'манка (Кг,гр)'/*29*/,'овсянка (Кг,гр)'/*31*/,'крупа кукурузная (Кг,гр)'/*51*/,'гречка (Кг,гр)'/*33*/,'пшено (Кг,гр)'/*35*/,'ячневая  (Кг,гр)'/*37*/,'перловка (Кг,гр)'/*40*/,'крупа ячменная (Кг,гр)'/*48*/,'талкан (Кг,гр)'/*42*/,'геркулес (зерна злаков)  (Кг,гр)'/*44*/,'крупа 5-7 злаков (Кг,гр)'/*46*/,'палочки кукурузные, попкорн (Кг,гр)'/*608*/,'крахмал пшеничный (Кг,гр)'/*683*/,'крахмал  кукурузный (Кг,гр)'/*684*/,'крахмал картофельный (Кг,гр)'/*685*/,'сумолок (Кг,гр)'/*686*/,'мед искусственный (Кг,гр)'/*514*/,'кукурузное масло нерафинированное (Л,мл)'/*480*/,'рафинированное кукурузное масло (Л,мл)'/*486*/,'хлеб ржаной (Кг,гр)'/*6*/,'хлеб пшеничный белый, серый (Кг,гр)'/*7*/,'лепешки (Кг,гр)'/*8*/,'пирожное (Кг,гр)'/*62*/,'торт (Кг,гр)'/*66*/,'пироги, пирожки, пончики (Кг,гр)'/*68*/,'булочки (Кг,гр)'/*64*/,'сладости восточные (чак-чак)(Кг,гр)'/*84*/,'сухари, кириешки (Кг,гр)'/*86*/,'пряники (Кг,гр)'/*70*/,'коржики, коврижки (Кг,гр)'/*73*/,'кексы (Кг,гр)'/*88*/,'рулет (Кг,гр)'/*75*/,'печенье (Кг,гр)'/*77*/,'вафли (Кг,гр)'/*81*/,'макароны (Кг,гр)'/*11*/,'вермишель (Кг,гр)'/*13*/,'лапша (Кг,гр)'/*15*/,'рожки (Кг,гр)'/*18*/,'лагман (Кг,гр)'/*20*/,'сахар (песок, рафинад) (Кг,гр)'/*501*/,'шоколад плиточный (Кг,гр)'/*503*/,'шоколадная паста (Кг,гр)'/*516*/,'пастила, зефир (Кг,гр)'/*510*/,'мармелад (Кг,гр)'/*511*/,'халва (Кг,гр)'/*509*/,'нават (сладости восточные) (Кг,гр)'/*512*/,'финики (Кг,гр.)'/*667*/,'финики (Кг,гр.)'/*667*/,'тесто недрожжевое (Кг,гр)'/*604*/,'пельмени (Кг,гр)'/*601*/,'вареники (Кг,гр)'/*602*/,'кукси (Кг,гр)'/*603*/,'фунчеза (изделия макаронные не включенные в другие группы) (Кг,гр)'/*605*/,'вино домашнее, сидр прочие фруктовые вина (Л,мл.)'/*631*/,'бозо (Л,мл.)'/*632*/,'лимонад, кола, фанта (Л,мл.)'/*635*/,'квас (Л,мл.)'/*636*/,'максым-шоро, жарма (Л,мл.)'/*637*/,'махорка (Кг,гр)'/*640*/,'насвай (Кг,гр)'/*642*/,'помидоры маринованные (Л,мл.)'/*134*/,'сахар для диабетиков (Кг,гр)'/*502*/,'семена хлопка (для переработки на масло) (Кг,гр)'/*681*/,'семена подсолнечника (Кг,гр.)'/*682*/,'кумыс (Л,мл.)'/*456*/,'рис (Кг,гр)'/*22*/,'табак курительный (Кг,гр)'/*641*/,'рыба свежая (Кг,гр.)'/*532*/,'колбаса варенная (сосиски, сардельки) (Кг,гр)'/*205*/,'субпродукты 1 категории  (диафрагма, печень говяжья, баранья, свиная) (Кг,гр)'/*228*/,'субпродукты 2 категории (уши, губы, ножки) (Кг,гр)'/*231*/,'субпродукты 1 категории  (сердце, язык, почки, вымя, мозги) (Кг,гр)'/*229*/,'кисель, инвайт (Кг,гр.)'/*592*/]) as title
),

cte_valid_products_vpodarok as (
    select unnest(array['169','186','171','178','215','221','101','113','112','55','59','53','57','115','114','127','119','118','117','120','166','174','125','111','124','110','121','122','123','103','106','109','107','108','104','105','126','102','116','187','173','161','162','161','170','182','163','168','179','176','177','184','205','427','429','531','513','216','218','217','219','220','227','223','224','201','202','230','580','175','573','582','627','225','536','540','539','538','153','428','430','439','440','441','609','79','90','92','561','504','505','687','508','507','506','634','639','638','692','167','172','164','165','180','487','488','562','563','565','564','566','577','576','578','579','591','574','581','454','455','575','586','587','583','515','226','689','690','691','624','625','626','629','630','633','584','585','589','183','185','181','232','222','546','590','567','568','569','571','572','515','515','628','211','210','213','212','208','207','204','204','206','214','203','235','209','234','233','534','535','537','533','541','542','543','544','545','607','621','622','623','131','143','151','149','155','139','138','144','570','150','142','140','141','137','137','137','132','133','134','136','147','135','154','651','652','658','654','655','657','659','152','660','661','665','662','663','664','666','588','153','475','476','477','478','479','481','482','483','484','485','446','431','489','490','491','437','443','444','449','450','451','453','452','432','433','434','436','435','438','448','442','447','445','457','426','24','1','606','26','29','31','51','33','35','37','40','48','42','44','46','608','683','684','685','686','514','480','486','6','7','8','62','66','68','64','84','86','70','73','88','75','77','81','11','13','15','18','20','501','503','516','510','511','509','512','667','667','604','601','602','603','605','631','632','635','636','637','640','642','134','502','681','682','456','22','641','532','205','228','231','229','592']) as code,
    unnest(array['виноград (Кг,гр.)'/*169*/,'хурма (Кг,гр.)'/*186*/,'гранат (Кг,гр.)'/*171*/,'лимон (Кг,гр.)'/*178*/,'куры, цыплята (Кг,гр.)'/*215*/,'мясо индейки (Кг,гр.)'/*221*/,'кукуруза (в початках) (Кг,гр.)'/*101*/,'зеленый фасоль в стручках  (Кг,гр.)'/*113*/,'зеленый горошек в стручках (Кг,гр.)'/*112*/,'фасоль (Кг,гр)'/*55*/,'чечевица сушеная (Кг, гр)'/*59*/,'горох (Кг,гр)'/*53*/,'маш (Кг,гр)'/*57*/,'капуста белокочанная (Кг,гр.)'/*115*/,'цветная капуста (Кг,гр.)'/*114*/,'салат-латук (Кг,гр.)'/*127*/,'петрушка (Кг,гр.)'/*119*/,'укроп (Кг,гр.)'/*118*/,'щавель (Кг,гр.)'/*117*/,'прочая зелень (жондо, сельдерей, жусай, райхон) (Кг,гр.)'/*120*/,'арбуз (Кг,гр.)'/*166*/,'дыня (Кг,гр.)'/*174*/,'перец свежий ( болгарский, горький) (Кг,гр.)'/*125*/,'огурцы (Кг,гр.)'/*111*/,'баклажаны (Кг,гр.)'/*124*/,'помидоры (Кг,гр.)'/*110*/,'тыква (Кг,гр.)'/*121*/,'кабачки (Кг,гр.)'/*122*/,'патиссоны (Кг,гр.)'/*123*/,'морковь (Кг,гр.)'/*103*/,'репа (Кг,гр.)'/*106*/,'чеснок (Кг,гр.)'/*109*/,'лук репчатый (Кг,гр.)'/*107*/,'лук зеленый (Кг,гр.)'/*108*/,'свекла (Кг,гр.)'/*104*/,'редька, редис (Кг,гр.)'/*105*/,'хрен (Кг,гр.)'/*126*/,'картофель (Кг,гр.)'/*102*/,'грибы свежие (Кг,гр.)'/*116*/,'яблоки (Кг,гр.)'/*187*/,'груши (Кг,гр.)'/*173*/,'абрикос (Кг,гр.)'/*161*/,'айва (Кг,гр.)'/*162*/,'абрикос (Кг,гр.)'/*161*/,'вишня, черешня (Кг,гр.)'/*170*/,'персик (Кг,гр.)'/*182*/,'алыча (Кг,гр.)'/*163*/,'барбарис (Кг,гр.)'/*168*/,'малина (Кг,гр.)'/*179*/,'клубника (Кг,гр.)'/*176*/,'крыжовник (Кг,гр.)'/*177*/,'смородина (Кг,гр.)'/*184*/,'колбаса варенная (сосиски, сардельки) (Кг,гр)'/*205*/,'молоко домашнее коровье (Л,мл.)'/*427*/,'молоко домашнее козье (Л,мл.)'/*429*/,'яйца (Шт)'/*531*/,'мед натуральный (Кг,гр)'/*513*/,'мясо говядина  (Кг,гр.)'/*216*/,'мясо свинина (Кг,гр.)'/*218*/,'мясо баранина (Кг,гр.)'/*217*/,'мясо козлятина (Кг,гр.)'/*219*/,'мясо конина (Кг,гр.)'/*220*/,'субпродукты 1 категории  (головное мясо, хвост, мясная обрез) (Кг,гр)'/*227*/,'мясо кролика (Кг,гр.)'/*223*/,'мясо нутрий (Кг,гр.)'/*224*/,'жир свиной, сало (Кг,гр.)'/*201*/,'жир скота (бараний, говяжий, овец, коз) (Кг,гр.)'/*202*/,'субпродукты 2 категории (легкие, селезенка, желудок, кишки) (Кг,гр)'/*230*/,'мак (Кг,гр.)'/*580*/,'киви, манго, папайя (Кг,гр.)'/*175*/,'черный перец горошком (Кг,гр.)'/*573*/,'соль морская (Кг,гр)'/*582*/,'бальзам (Л,мл.)'/*627*/,'окорочка куринные (Кг,гр.)'/*225*/,'сельдь в банках (Кг,гр.)'/*536*/,'рыбные консервы в собственном соку (Кг,гр.)'/*540*/,'рыбные консервы в томатном соусе (Кг,гр.)'/*539*/,'рыбные консервы в масле (Кг,гр.)'/*538*/,'фруктовые компоты (консервированные) (Л,мл.)'/*153*/,'молоко пастеризованное (Л,мл.)'/*428*/,'молоко топленое (Л,мл.)'/*430*/,'сухое молоко, сухие сливки (Кг,гр)'/*439*/,'сырки творожные нежирные (Кг,гр)'/*440*/,'сырки творожные в шоколаде, рыжий ап (Кг,гр)'/*441*/,'сухие завтраки (хлопья, колечки) (Кг,гр)'/*609*/,'шоколадно вафельный торт (Кг,гр)'/*79*/,'сушки, соломка, хлебные палочки (Кг,гр)'/*90*/,'бублики (Кг,гр)'/*92*/,'какао порошок (Кг,гр.)'/*561*/,'батончики шоколадные  (сникерс, марс) (Кг,гр)'/*504*/,'конфеты шоколадные (Кг,гр)'/*505*/,'жевательная резинка (Кг,гр)'/*687*/,'ирис (Кг,гр)'/*508*/,'леденцы (Кг,гр)'/*507*/,'конфеты карамель с начинкой (Кг,гр)'/*506*/,'минеральная вода (Л,мл.)'/*634*/,'папиросы (Шт)'/*639*/,'сигареты с фильтром (Шт)'/*638*/,'гематоген (Кг,гр)'/*692*/,'банан (Кг,гр.)'/*167*/,'грейпфруты (Кг,гр.)'/*172*/,'ананас (Кг,гр.)'/*164*/,'апельсин (Кг,гр.)'/*165*/,'мандарин (Кг,гр.)'/*180*/,'маргарин (Кг,гр)'/*487*/,'маргарин (рама, щедрое лето, иртыш) (Кг,гр)'/*488*/,'кофе в зернах (Кг,гр.)'/*562*/,'кофе растворимый (Кг,гр.)'/*563*/,'чай зеленый (Кг,гр.)'/*565*/,'чай черный (Кг,гр.)'/*564*/,'уксус (Л,мл.)'/*566*/,'корица (Кг,гр.)'/*577*/,'ванилин (Кг,гр.)'/*576*/,'гвоздика (Кг,гр.)'/*578*/,'лавровый лист (Кг,гр.)'/*579*/,'имбирь (Кг,гр.)'/*591*/,'приправы сухие (кинза, зире, кристаллики)(Кг,гр.)'/*574*/,'соль (Кг,гр)'/*581*/,'детское питание (на молочной основе) (Кг,гр)'/*454*/,'детское питание в виде смесей на гречневых, рисовых, овсяных отварах (Кг,гр)'/*455*/,'бульонные кубики, порошок (Ролтон, Маги) (Кг,гр.)'/*575*/,'дрожжи сухие (Кг,гр.)'/*586*/,'дрожжи сырые (Кг,гр.)'/*587*/,'разрыхлитель теста (Кг,гр.)'/*583*/,'сиропы разные (Кг,гр)'/*515*/,'соевое мясо, соевый сыр и фарш (Кг,гр)'/*226*/,'корм для декоративных птиц (Кг,гр)'/*689*/,'корм собакам (Кг,гр)'/*690*/,'корм кошкам (Кг,гр)'/*691*/,'коньяк (Л,мл.)'/*624*/,'водка (Л,мл.)'/*625*/,'спирт (Л,мл.)'/*626*/,'шампанское (Л,мл.)'/*629*/,'вино заводское, виноградные натуральные вина (Л,мл.)'/*630*/,'пиво (Л,мл.)'/*633*/,'сода пищевая (Кг,гр.)'/*584*/,'лимонная кислота (Кг,гр.)'/*585*/,'желатин (Кг,гр.)'/*589*/,'слива (Кг,гр.)'/*183*/,'урюк (Кг,гр.)'/*185*/,'облепиха (Кг,гр.)'/*181*/,'субпродукты птиц (Кг,гр.)'/*232*/,'мясо уток, гусей (Кг,гр.)'/*222*/,'морская капуста (Кг,гр.)'/*546*/,'соевый соус (Кг,гр.)'/*590*/,'кетчуп (Л,мл.)'/*567*/,'горчица (Кг,гр.)'/*568*/,'майонез (Кг,гр.)'/*569*/,'аджика (сухой томат) (Л,мл.)'/*571*/,'перец черный, красный молотый (Кг,гр.)'/*572*/,'сиропы разные (Кг,гр)'/*515*/,'сиропы разные (Кг,гр)'/*515*/,'самогон (Л,мл.)'/*628*/,'копчености мясные  из свинины (Кг,гр)'/*211*/,'копчености мясные  из говядины (Кг,гр)'/*210*/,'копчености мясные из конины (Кг,гр)'/*213*/,'копчености мясные из баранины (Кг,гр)'/*212*/,'копченные окорочка (Кг,гр)'/*208*/,'колбаса ливерная, кровяная, печеночная (Кг,гр)'/*207*/,'колбаса варенная ( докторская, чайная,  (Кг,гр)'/*204*/,'колбаса варенная ( докторская, чайная,  (Кг,гр)'/*204*/,'колбаса копченная  (Кг,гр)'/*206*/,'сырокопченая колбаса (Кг,гр)'/*214*/,'карта, чучук, казы (Кг,гр)'/*203*/,'холодец (Кг,гр)'/*235*/,'гриль (Кг,гр)'/*209*/,'фарш (Кг,гр)'/*234*/,'тушенка (консервы) (Кг,гр)'/*233*/,'вяленная рыба (Кг,гр.)'/*534*/,'сельдь соленая (Кг,гр.)'/*535*/,'сельдь копченная (Кг,гр.)'/*537*/,'рыба копченая (Кг,гр.)'/*533*/,'паштет рыбный (Кг,гр.)'/*541*/,'присервы рыбные (Кг,гр.)'/*542*/,'икра осетровых рыб (Кг,гр.)'/*543*/,'икра рыбная (Кг,гр.)'/*544*/,'крабовые палочки (Кг,гр.)'/*545*/,'картофельные чипсы (Кг,гр)'/*607*/,'сок овощной (Л,мл.)'/*621*/,'сок фруктовый (Л,мл.)'/*622*/,'соки ассорти(искусственные)(л мл)'/*623*/,'салаты консервированные (Л,мл.)'/*131*/,'огурцы соленые (Кг,гр.)'/*143*/,'овощи и грибы сушеные (Кг,гр.)'/*151*/,'грибы сушенные (Кг,гр.)'/*149*/,'спаржа (Кг,гр)'/*155*/,'фасоль консервированная (Кг,гр.)'/*139*/,'горошек консервированный (Кг,гр.)'/*138*/,'помидоры соленые (Кг,гр.)'/*144*/,'томатная паста     (Кг,гр.)'/*570*/,'грибы соленные  (Кг,гр.)'/*150*/,'капуста квашеная (Кг,гр.)'/*142*/,'маслины и оливки консервированные (Кг,гр.)'/*140*/,'кукуруза консервированная (Кг,гр.)'/*141*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты консервированные с уксусом (л,мл)'/*132*/,'огурцы маринованные (Л,мл.)'/*133*/,'помидоры маринованные (Л,мл.)'/*134*/,'ассорти овощное консервированное (Л,мл.)'/*136*/,'овощи (патиссоны, кабачки) и салаты, маринованные (Л,мл.)'/*147*/,'грибы маринованные (Л,мл.)'/*135*/,'повидло, джем, варенье (Кг,гр.)'/*154*/,'бобы соевые (Кг,гр)'/*651*/,'миндаль (Кг,гр.)'/*652*/,'арахис обжаренный (соленный, обработанный) (Кг,гр.)'/*658*/,'фундук (Кг,гр.)'/*654*/,'фисташки (Кг,гр.)'/*655*/,'орех мускатный (Кг,гр.)'/*657*/,'орехи обработанные (орех лесной, грецкие орехи) (Кг,гр.)'/*659*/,'ананасы консервированные (Кг,гр.)'/*152*/,'виноград сушенный (изюм) (Кг,гр.)'/*660*/,'фрукты сушеные прочие (Кг,гр.)'/*661*/,'абрикос (курага) (Кг,гр.)'/*665*/,'чернослив (Кг,гр.)'/*662*/,'яблоки и груши (Кг,гр.)'/*663*/,'смеси сухофруктов (Кг,гр.)'/*664*/,'косточки и ядра абрикосов, персиков и слив (Кг,гр.)'/*666*/,'кокосовая стружка (Кг,гр.)'/*588*/,'фруктовые компоты (консервированные) (Л,мл.)'/*153*/,'соевое масло нерафинированное (Л,мл)'/*475*/,'оливковое масло нерафинированные (Л,мл)'/*476*/,'подсолнечное и сафлоровое масло нерафинированное (Л,мл)'/*477*/,'хлопковое масло нерафинированное (Л,мл)'/*478*/,'рапсовое, сурепное  и горчичное нерафинированное (Л,мл)'/*479*/,'рафинированное соевое масло (Л,мл)'/*481*/,'рафинированное оливковое масло (Л,мл)'/*482*/,'рафинированное подсолнечное и сафлоровое масло  (Л,мл)'/*483*/,'рафинированное хлопковое масло (Л,мл)'/*484*/,'рафинированное рапсовое, сурепное и горчичное масло (Л,мл)'/*485*/,'обрат (Л,мл.)'/*446*/,'сливки жидкие (Л,мл.)'/*431*/,'масло сливочное (Кг,гр)'/*489*/,'масло шоколадное (Кг,гр)'/*490*/,'масло топленное (Кг,гр)'/*491*/,'суюзмо (Кг,гр)'/*437*/,'творог нежирный (Кг,гр)'/*443*/,'творог жирный (Кг,гр)'/*444*/,'сыр твердые (голландский, российский тильзитский) (Кг,гр)'/*449*/,'сыр мягкий (адыгейский, сулугуни) (Кг,гр)'/*450*/,'сыры рассольные (брынза) (Кг,гр)'/*451*/,'сыр плавленый и с наполнителями (Кг,гр)'/*453*/,'сыр колбасный (Кг,гр)'/*452*/,'сгущенка (Кг,гр)'/*432*/,'айран, простокваша (Л,мл.)'/*433*/,'кефир (Л,мл.)'/*434*/,'ряженка (Л,мл.)'/*436*/,'сметана (Л,мл.)'/*435*/,'биолакт (Л,мл.)'/*438*/,'курут (Кг,гр)'/*448*/,'йогурт, фругурт (Кг,гр)'/*442*/,'пахта (Л,мл.)'/*447*/,'сыворотка (Л,мл.)'/*445*/,'тан, той-бос (Л,мл.)'/*457*/,'мороженное (Кг,гр.)'/*426*/,'рисовая сечка (Кг,гр)'/*24*/,'мука пшеничная (Кг,гр)'/*1*/,'смеси и тесто для приготовления хлебобулочных изделий (Кг,гр)'/*606*/,'крупа пшеничная (Кг,гр)'/*26*/,'манка (Кг,гр)'/*29*/,'овсянка (Кг,гр)'/*31*/,'крупа кукурузная (Кг,гр)'/*51*/,'гречка (Кг,гр)'/*33*/,'пшено (Кг,гр)'/*35*/,'ячневая  (Кг,гр)'/*37*/,'перловка (Кг,гр)'/*40*/,'крупа ячменная (Кг,гр)'/*48*/,'талкан (Кг,гр)'/*42*/,'геркулес (зерна злаков)  (Кг,гр)'/*44*/,'крупа 5-7 злаков (Кг,гр)'/*46*/,'палочки кукурузные, попкорн (Кг,гр)'/*608*/,'крахмал пшеничный (Кг,гр)'/*683*/,'крахмал  кукурузный (Кг,гр)'/*684*/,'крахмал картофельный (Кг,гр)'/*685*/,'сумолок (Кг,гр)'/*686*/,'мед искусственный (Кг,гр)'/*514*/,'кукурузное масло нерафинированное (Л,мл)'/*480*/,'рафинированное кукурузное масло (Л,мл)'/*486*/,'хлеб ржаной (Кг,гр)'/*6*/,'хлеб пшеничный белый, серый (Кг,гр)'/*7*/,'лепешки (Кг,гр)'/*8*/,'пирожное (Кг,гр)'/*62*/,'торт (Кг,гр)'/*66*/,'пироги, пирожки, пончики (Кг,гр)'/*68*/,'булочки (Кг,гр)'/*64*/,'сладости восточные (чак-чак)(Кг,гр)'/*84*/,'сухари, кириешки (Кг,гр)'/*86*/,'пряники (Кг,гр)'/*70*/,'коржики, коврижки (Кг,гр)'/*73*/,'кексы (Кг,гр)'/*88*/,'рулет (Кг,гр)'/*75*/,'печенье (Кг,гр)'/*77*/,'вафли (Кг,гр)'/*81*/,'макароны (Кг,гр)'/*11*/,'вермишель (Кг,гр)'/*13*/,'лапша (Кг,гр)'/*15*/,'рожки (Кг,гр)'/*18*/,'лагман (Кг,гр)'/*20*/,'сахар (песок, рафинад) (Кг,гр)'/*501*/,'шоколад плиточный (Кг,гр)'/*503*/,'шоколадная паста (Кг,гр)'/*516*/,'пастила, зефир (Кг,гр)'/*510*/,'мармелад (Кг,гр)'/*511*/,'халва (Кг,гр)'/*509*/,'нават (сладости восточные) (Кг,гр)'/*512*/,'финики (Кг,гр.)'/*667*/,'финики (Кг,гр.)'/*667*/,'тесто недрожжевое (Кг,гр)'/*604*/,'пельмени (Кг,гр)'/*601*/,'вареники (Кг,гр)'/*602*/,'кукси (Кг,гр)'/*603*/,'фунчеза (изделия макаронные не включенные в другие группы) (Кг,гр)'/*605*/,'вино домашнее, сидр прочие фруктовые вина (Л,мл.)'/*631*/,'бозо (Л,мл.)'/*632*/,'лимонад, кола, фанта (Л,мл.)'/*635*/,'квас (Л,мл.)'/*636*/,'максым-шоро, жарма (Л,мл.)'/*637*/,'махорка (Кг,гр)'/*640*/,'насвай (Кг,гр)'/*642*/,'помидоры маринованные (Л,мл.)'/*134*/,'сахар для диабетиков (Кг,гр)'/*502*/,'семена хлопка (для переработки на масло) (Кг,гр)'/*681*/,'семена подсолнечника (Кг,гр.)'/*682*/,'кумыс (Л,мл.)'/*456*/,'рис (Кг,гр)'/*22*/,'табак курительный (Кг,гр)'/*641*/,'рыба свежая (Кг,гр.)'/*532*/,'колбаса варенная (сосиски, сардельки) (Кг,гр)'/*205*/,'субпродукты 1 категории  (диафрагма, печень говяжья, баранья, свиная) (Кг,гр)'/*228*/,'субпродукты 2 категории (уши, губы, ножки) (Кг,гр)'/*231*/,'субпродукты 1 категории  (сердце, язык, почки, вымя, мозги) (Кг,гр)'/*229*/,'кисель, инвайт (Кг,гр.)'/*592*/]) as title
),

cte_valid_products_pererabotka as (
    select unnest(array['546','590','567','568','569','571','572','515','515','628','211','210','213','212','208','207','204','205','204','206','214','203','235','209','234','233','534','535','537','533','541','542','543','544','545','607','621','622','623','131','143','151','149','155','139','138','144','570','150','142','140','141','137','137','137','132','133','134','136','147','135','154','651','652','658','654','655','657','659','152','660','661','665','662','663','664','666','588','153','475','476','477','478','479','481','482','483','484','485','446','431','489','490','491','437','443','444','449','450','451','453','452','432','433','434','436','435','438','448','442','447','445','457','426','24','1','606','26','29','31','51','33','35','37','40','48','42','44','46','608','683','684','685','686','514','480','486','6','7','8','62','66','68','64','84','86','70','73','88','75','77','81','11','13','15','18','20','501','503','516','510','511','509','512','667','667','604','601','602','603','605','631','632','635','636','637','640','642','134','502','681','682','456','22','641','205']) as code,
    unnest(array['морская капуста (Кг,гр.)'/*546*/,'соевый соус (Кг,гр.)'/*590*/,'кетчуп (Л,мл.)'/*567*/,'горчица (Кг,гр.)'/*568*/,'майонез (Кг,гр.)'/*569*/,'аджика (сухой томат) (Л,мл.)'/*571*/,'перец черный, красный молотый (Кг,гр.)'/*572*/,'сиропы разные (Кг,гр)'/*515*/,'сиропы разные (Кг,гр)'/*515*/,'самогон (Л,мл.)'/*628*/,'копчености мясные  из свинины (Кг,гр)'/*211*/,'копчености мясные  из говядины (Кг,гр)'/*210*/,'копчености мясные из конины (Кг,гр)'/*213*/,'копчености мясные из баранины (Кг,гр)'/*212*/,'копченные окорочка (Кг,гр)'/*208*/,'колбаса ливерная, кровяная, печеночная (Кг,гр)'/*207*/,'колбаса варенная ( докторская, чайная,  (Кг,гр)'/*204*/,'колбаса варенная (сосиски, сардельки) (Кг,гр)'/*205*/,'колбаса варенная ( докторская, чайная,  (Кг,гр)'/*204*/,'колбаса копченная  (Кг,гр)'/*206*/,'сырокопченая колбаса (Кг,гр)'/*214*/,'карта, чучук, казы (Кг,гр)'/*203*/,'холодец (Кг,гр)'/*235*/,'гриль (Кг,гр)'/*209*/,'фарш (Кг,гр)'/*234*/,'тушенка (консервы) (Кг,гр)'/*233*/,'вяленная рыба (Кг,гр.)'/*534*/,'сельдь соленая (Кг,гр.)'/*535*/,'сельдь копченная (Кг,гр.)'/*537*/,'рыба копченая (Кг,гр.)'/*533*/,'паштет рыбный (Кг,гр.)'/*541*/,'присервы рыбные (Кг,гр.)'/*542*/,'икра осетровых рыб (Кг,гр.)'/*543*/,'икра рыбная (Кг,гр.)'/*544*/,'крабовые палочки (Кг,гр.)'/*545*/,'картофельные чипсы (Кг,гр)'/*607*/,'сок овощной (Л,мл.)'/*621*/,'сок фруктовый (Л,мл.)'/*622*/,'соки ассорти(искусственные)(л мл)'/*623*/,'салаты консервированные (Л,мл.)'/*131*/,'огурцы соленые (Кг,гр.)'/*143*/,'овощи и грибы сушеные (Кг,гр.)'/*151*/,'грибы сушенные (Кг,гр.)'/*149*/,'спаржа (Кг,гр)'/*155*/,'фасоль консервированная (Кг,гр.)'/*139*/,'горошек консервированный (Кг,гр.)'/*138*/,'помидоры соленые (Кг,гр.)'/*144*/,'томатная паста     (Кг,гр.)'/*570*/,'грибы соленные  (Кг,гр.)'/*150*/,'капуста квашеная (Кг,гр.)'/*142*/,'маслины и оливки консервированные (Кг,гр.)'/*140*/,'кукуруза консервированная (Кг,гр.)'/*141*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты консервированные с уксусом (л,мл)'/*132*/,'огурцы маринованные (Л,мл.)'/*133*/,'помидоры маринованные (Л,мл.)'/*134*/,'ассорти овощное консервированное (Л,мл.)'/*136*/,'овощи (патиссоны, кабачки) и салаты, маринованные (Л,мл.)'/*147*/,'грибы маринованные (Л,мл.)'/*135*/,'повидло, джем, варенье (Кг,гр.)'/*154*/,'бобы соевые (Кг,гр)'/*651*/,'миндаль (Кг,гр.)'/*652*/,'арахис обжаренный (соленный, обработанный) (Кг,гр.)'/*658*/,'фундук (Кг,гр.)'/*654*/,'фисташки (Кг,гр.)'/*655*/,'орех мускатный (Кг,гр.)'/*657*/,'орехи обработанные (орех лесной, грецкие орехи) (Кг,гр.)'/*659*/,'ананасы консервированные (Кг,гр.)'/*152*/,'виноград сушенный (изюм) (Кг,гр.)'/*660*/,'фрукты сушеные прочие (Кг,гр.)'/*661*/,'абрикос (курага) (Кг,гр.)'/*665*/,'чернослив (Кг,гр.)'/*662*/,'яблоки и груши (Кг,гр.)'/*663*/,'смеси сухофруктов (Кг,гр.)'/*664*/,'косточки и ядра абрикосов, персиков и слив (Кг,гр.)'/*666*/,'кокосовая стружка (Кг,гр.)'/*588*/,'фруктовые компоты (консервированные) (Л,мл.)'/*153*/,'соевое масло нерафинированное (Л,мл)'/*475*/,'оливковое масло нерафинированные (Л,мл)'/*476*/,'подсолнечное и сафлоровое масло нерафинированное (Л,мл)'/*477*/,'хлопковое масло нерафинированное (Л,мл)'/*478*/,'рапсовое, сурепное  и горчичное нерафинированное (Л,мл)'/*479*/,'рафинированное соевое масло (Л,мл)'/*481*/,'рафинированное оливковое масло (Л,мл)'/*482*/,'рафинированное подсолнечное и сафлоровое масло  (Л,мл)'/*483*/,'рафинированное хлопковое масло (Л,мл)'/*484*/,'рафинированное рапсовое, сурепное и горчичное масло (Л,мл)'/*485*/,'обрат (Л,мл.)'/*446*/,'сливки жидкие (Л,мл.)'/*431*/,'масло сливочное (Кг,гр)'/*489*/,'масло шоколадное (Кг,гр)'/*490*/,'масло топленное (Кг,гр)'/*491*/,'суюзмо (Кг,гр)'/*437*/,'творог нежирный (Кг,гр)'/*443*/,'творог жирный (Кг,гр)'/*444*/,'сыр твердые (голландский, российский тильзитский) (Кг,гр)'/*449*/,'сыр мягкий (адыгейский, сулугуни) (Кг,гр)'/*450*/,'сыры рассольные (брынза) (Кг,гр)'/*451*/,'сыр плавленый и с наполнителями (Кг,гр)'/*453*/,'сыр колбасный (Кг,гр)'/*452*/,'сгущенка (Кг,гр)'/*432*/,'айран, простокваша (Л,мл.)'/*433*/,'кефир (Л,мл.)'/*434*/,'ряженка (Л,мл.)'/*436*/,'сметана (Л,мл.)'/*435*/,'биолакт (Л,мл.)'/*438*/,'курут (Кг,гр)'/*448*/,'йогурт, фругурт (Кг,гр)'/*442*/,'пахта (Л,мл.)'/*447*/,'сыворотка (Л,мл.)'/*445*/,'тан, той-бос (Л,мл.)'/*457*/,'мороженное (Кг,гр.)'/*426*/,'рисовая сечка (Кг,гр)'/*24*/,'мука пшеничная (Кг,гр)'/*1*/,'смеси и тесто для приготовления хлебобулочных изделий (Кг,гр)'/*606*/,'крупа пшеничная (Кг,гр)'/*26*/,'манка (Кг,гр)'/*29*/,'овсянка (Кг,гр)'/*31*/,'крупа кукурузная (Кг,гр)'/*51*/,'гречка (Кг,гр)'/*33*/,'пшено (Кг,гр)'/*35*/,'ячневая  (Кг,гр)'/*37*/,'перловка (Кг,гр)'/*40*/,'крупа ячменная (Кг,гр)'/*48*/,'талкан (Кг,гр)'/*42*/,'геркулес (зерна злаков)  (Кг,гр)'/*44*/,'крупа 5-7 злаков (Кг,гр)'/*46*/,'палочки кукурузные, попкорн (Кг,гр)'/*608*/,'крахмал пшеничный (Кг,гр)'/*683*/,'крахмал  кукурузный (Кг,гр)'/*684*/,'крахмал картофельный (Кг,гр)'/*685*/,'сумолок (Кг,гр)'/*686*/,'мед искусственный (Кг,гр)'/*514*/,'кукурузное масло нерафинированное (Л,мл)'/*480*/,'рафинированное кукурузное масло (Л,мл)'/*486*/,'хлеб ржаной (Кг,гр)'/*6*/,'хлеб пшеничный белый, серый (Кг,гр)'/*7*/,'лепешки (Кг,гр)'/*8*/,'пирожное (Кг,гр)'/*62*/,'торт (Кг,гр)'/*66*/,'пироги, пирожки, пончики (Кг,гр)'/*68*/,'булочки (Кг,гр)'/*64*/,'сладости восточные (чак-чак)(Кг,гр)'/*84*/,'сухари, кириешки (Кг,гр)'/*86*/,'пряники (Кг,гр)'/*70*/,'коржики, коврижки (Кг,гр)'/*73*/,'кексы (Кг,гр)'/*88*/,'рулет (Кг,гр)'/*75*/,'печенье (Кг,гр)'/*77*/,'вафли (Кг,гр)'/*81*/,'макароны (Кг,гр)'/*11*/,'вермишель (Кг,гр)'/*13*/,'лапша (Кг,гр)'/*15*/,'рожки (Кг,гр)'/*18*/,'лагман (Кг,гр)'/*20*/,'сахар (песок, рафинад) (Кг,гр)'/*501*/,'шоколад плиточный (Кг,гр)'/*503*/,'шоколадная паста (Кг,гр)'/*516*/,'пастила, зефир (Кг,гр)'/*510*/,'мармелад (Кг,гр)'/*511*/,'халва (Кг,гр)'/*509*/,'нават (сладости восточные) (Кг,гр)'/*512*/,'финики (Кг,гр.)'/*667*/,'финики (Кг,гр.)'/*667*/,'тесто недрожжевое (Кг,гр)'/*604*/,'пельмени (Кг,гр)'/*601*/,'вареники (Кг,гр)'/*602*/,'кукси (Кг,гр)'/*603*/,'фунчеза (изделия макаронные не включенные в другие группы) (Кг,гр)'/*605*/,'вино домашнее, сидр прочие фруктовые вина (Л,мл.)'/*631*/,'бозо (Л,мл.)'/*632*/,'лимонад, кола, фанта (Л,мл.)'/*635*/,'квас (Л,мл.)'/*636*/,'максым-шоро, жарма (Л,мл.)'/*637*/,'махорка (Кг,гр)'/*640*/,'насвай (Кг,гр)'/*642*/,'помидоры маринованные (Л,мл.)'/*134*/,'сахар для диабетиков (Кг,гр)'/*502*/,'семена хлопка (для переработки на масло) (Кг,гр)'/*681*/,'семена подсолнечника (Кг,гр.)'/*682*/,'кумыс (Л,мл.)'/*456*/,'рис (Кг,гр)'/*22*/,'табак курительный (Кг,гр)'/*641*/,'колбаса варенная (сосиски, сардельки) (Кг,гр)'/*205*/]) as title
),

cte_valid_products_natura as (
    select unnest(array['169','186','171','178','215','221','101','113','112','55','59','53','57','115','114','127','119','118','117','120','166','174','125','111','124','110','121','122','123','103','106','109','107','108','104','105','126','102','116','187','173','161','162','161','170','182','163','168','179','176','177','184','205','427','429','531','513','216','218','217','219','220','227','223','224','201','202','230','580','175','573','582','627','225','536','540','539','538','153','428','430','439','440','441','609','79','90','92','561','504','505','687','508','507','506','634','639','638','692','167','172','164','165','180','487','488','562','563','565','564','566','577','576','578','579','591','574','581','454','455','575','586','587','583','515','226','689','690','691','624','625','626','629','630','633','584','585','589','183','185','181','232','222','546','590','567','568','569','571','572','515','515','628','211','210','213','212','208','207','204','204','206','214','203','235','209','234','233','534','535','537','533','541','542','543','544','545','607','621','622','623','131','143','151','149','155','139','138','144','570','150','142','140','141','137','137','137','132','133','134','136','147','135','154','651','652','658','654','655','657','659','152','660','661','665','662','663','664','666','588','153','475','476','477','478','479','481','482','483','484','485','446','431','489','490','491','437','443','444','449','450','451','453','452','432','433','434','436','435','438','448','442','447','445','457','426','24','1','606','26','29','31','51','33','35','37','40','48','42','44','46','608','683','684','685','686','514','480','486','6','7','8','62','66','68','64','84','86','70','73','88','75','77','81','11','13','15','18','20','501','503','516','510','511','509','512','667','667','604','601','602','603','605','631','632','635','636','637','640','642','134','502','681','682','456','22','641','532','205','228','231','229','592']) as code,
    unnest(array['виноград (Кг,гр.)'/*169*/,'хурма (Кг,гр.)'/*186*/,'гранат (Кг,гр.)'/*171*/,'лимон (Кг,гр.)'/*178*/,'куры, цыплята (Кг,гр.)'/*215*/,'мясо индейки (Кг,гр.)'/*221*/,'кукуруза (в початках) (Кг,гр.)'/*101*/,'зеленый фасоль в стручках  (Кг,гр.)'/*113*/,'зеленый горошек в стручках (Кг,гр.)'/*112*/,'фасоль (Кг,гр)'/*55*/,'чечевица сушеная (Кг, гр)'/*59*/,'горох (Кг,гр)'/*53*/,'маш (Кг,гр)'/*57*/,'капуста белокочанная (Кг,гр.)'/*115*/,'цветная капуста (Кг,гр.)'/*114*/,'салат-латук (Кг,гр.)'/*127*/,'петрушка (Кг,гр.)'/*119*/,'укроп (Кг,гр.)'/*118*/,'щавель (Кг,гр.)'/*117*/,'прочая зелень (жондо, сельдерей, жусай, райхон) (Кг,гр.)'/*120*/,'арбуз (Кг,гр.)'/*166*/,'дыня (Кг,гр.)'/*174*/,'перец свежий ( болгарский, горький) (Кг,гр.)'/*125*/,'огурцы (Кг,гр.)'/*111*/,'баклажаны (Кг,гр.)'/*124*/,'помидоры (Кг,гр.)'/*110*/,'тыква (Кг,гр.)'/*121*/,'кабачки (Кг,гр.)'/*122*/,'патиссоны (Кг,гр.)'/*123*/,'морковь (Кг,гр.)'/*103*/,'репа (Кг,гр.)'/*106*/,'чеснок (Кг,гр.)'/*109*/,'лук репчатый (Кг,гр.)'/*107*/,'лук зеленый (Кг,гр.)'/*108*/,'свекла (Кг,гр.)'/*104*/,'редька, редис (Кг,гр.)'/*105*/,'хрен (Кг,гр.)'/*126*/,'картофель (Кг,гр.)'/*102*/,'грибы свежие (Кг,гр.)'/*116*/,'яблоки (Кг,гр.)'/*187*/,'груши (Кг,гр.)'/*173*/,'абрикос (Кг,гр.)'/*161*/,'айва (Кг,гр.)'/*162*/,'абрикос (Кг,гр.)'/*161*/,'вишня, черешня (Кг,гр.)'/*170*/,'персик (Кг,гр.)'/*182*/,'алыча (Кг,гр.)'/*163*/,'барбарис (Кг,гр.)'/*168*/,'малина (Кг,гр.)'/*179*/,'клубника (Кг,гр.)'/*176*/,'крыжовник (Кг,гр.)'/*177*/,'смородина (Кг,гр.)'/*184*/,'колбаса варенная (сосиски, сардельки) (Кг,гр)'/*205*/,'молоко домашнее коровье (Л,мл.)'/*427*/,'молоко домашнее козье (Л,мл.)'/*429*/,'яйца (Шт)'/*531*/,'мед натуральный (Кг,гр)'/*513*/,'мясо говядина  (Кг,гр.)'/*216*/,'мясо свинина (Кг,гр.)'/*218*/,'мясо баранина (Кг,гр.)'/*217*/,'мясо козлятина (Кг,гр.)'/*219*/,'мясо конина (Кг,гр.)'/*220*/,'субпродукты 1 категории  (головное мясо, хвост, мясная обрез) (Кг,гр)'/*227*/,'мясо кролика (Кг,гр.)'/*223*/,'мясо нутрий (Кг,гр.)'/*224*/,'жир свиной, сало (Кг,гр.)'/*201*/,'жир скота (бараний, говяжий, овец, коз) (Кг,гр.)'/*202*/,'субпродукты 2 категории (легкие, селезенка, желудок, кишки) (Кг,гр)'/*230*/,'мак (Кг,гр.)'/*580*/,'киви, манго, папайя (Кг,гр.)'/*175*/,'черный перец горошком (Кг,гр.)'/*573*/,'соль морская (Кг,гр)'/*582*/,'бальзам (Л,мл.)'/*627*/,'окорочка куринные (Кг,гр.)'/*225*/,'сельдь в банках (Кг,гр.)'/*536*/,'рыбные консервы в собственном соку (Кг,гр.)'/*540*/,'рыбные консервы в томатном соусе (Кг,гр.)'/*539*/,'рыбные консервы в масле (Кг,гр.)'/*538*/,'фруктовые компоты (консервированные) (Л,мл.)'/*153*/,'молоко пастеризованное (Л,мл.)'/*428*/,'молоко топленое (Л,мл.)'/*430*/,'сухое молоко, сухие сливки (Кг,гр)'/*439*/,'сырки творожные нежирные (Кг,гр)'/*440*/,'сырки творожные в шоколаде, рыжий ап (Кг,гр)'/*441*/,'сухие завтраки (хлопья, колечки) (Кг,гр)'/*609*/,'шоколадно вафельный торт (Кг,гр)'/*79*/,'сушки, соломка, хлебные палочки (Кг,гр)'/*90*/,'бублики (Кг,гр)'/*92*/,'какао порошок (Кг,гр.)'/*561*/,'батончики шоколадные  (сникерс, марс) (Кг,гр)'/*504*/,'конфеты шоколадные (Кг,гр)'/*505*/,'жевательная резинка (Кг,гр)'/*687*/,'ирис (Кг,гр)'/*508*/,'леденцы (Кг,гр)'/*507*/,'конфеты карамель с начинкой (Кг,гр)'/*506*/,'минеральная вода (Л,мл.)'/*634*/,'папиросы (Шт)'/*639*/,'сигареты с фильтром (Шт)'/*638*/,'гематоген (Кг,гр)'/*692*/,'банан (Кг,гр.)'/*167*/,'грейпфруты (Кг,гр.)'/*172*/,'ананас (Кг,гр.)'/*164*/,'апельсин (Кг,гр.)'/*165*/,'мандарин (Кг,гр.)'/*180*/,'маргарин (Кг,гр)'/*487*/,'маргарин (рама, щедрое лето, иртыш) (Кг,гр)'/*488*/,'кофе в зернах (Кг,гр.)'/*562*/,'кофе растворимый (Кг,гр.)'/*563*/,'чай зеленый (Кг,гр.)'/*565*/,'чай черный (Кг,гр.)'/*564*/,'уксус (Л,мл.)'/*566*/,'корица (Кг,гр.)'/*577*/,'ванилин (Кг,гр.)'/*576*/,'гвоздика (Кг,гр.)'/*578*/,'лавровый лист (Кг,гр.)'/*579*/,'имбирь (Кг,гр.)'/*591*/,'приправы сухие (кинза, зире, кристаллики)(Кг,гр.)'/*574*/,'соль (Кг,гр)'/*581*/,'детское питание (на молочной основе) (Кг,гр)'/*454*/,'детское питание в виде смесей на гречневых, рисовых, овсяных отварах (Кг,гр)'/*455*/,'бульонные кубики, порошок (Ролтон, Маги) (Кг,гр.)'/*575*/,'дрожжи сухие (Кг,гр.)'/*586*/,'дрожжи сырые (Кг,гр.)'/*587*/,'разрыхлитель теста (Кг,гр.)'/*583*/,'сиропы разные (Кг,гр)'/*515*/,'соевое мясо, соевый сыр и фарш (Кг,гр)'/*226*/,'корм для декоративных птиц (Кг,гр)'/*689*/,'корм собакам (Кг,гр)'/*690*/,'корм кошкам (Кг,гр)'/*691*/,'коньяк (Л,мл.)'/*624*/,'водка (Л,мл.)'/*625*/,'спирт (Л,мл.)'/*626*/,'шампанское (Л,мл.)'/*629*/,'вино заводское, виноградные натуральные вина (Л,мл.)'/*630*/,'пиво (Л,мл.)'/*633*/,'сода пищевая (Кг,гр.)'/*584*/,'лимонная кислота (Кг,гр.)'/*585*/,'желатин (Кг,гр.)'/*589*/,'слива (Кг,гр.)'/*183*/,'урюк (Кг,гр.)'/*185*/,'облепиха (Кг,гр.)'/*181*/,'субпродукты птиц (Кг,гр.)'/*232*/,'мясо уток, гусей (Кг,гр.)'/*222*/,'морская капуста (Кг,гр.)'/*546*/,'соевый соус (Кг,гр.)'/*590*/,'кетчуп (Л,мл.)'/*567*/,'горчица (Кг,гр.)'/*568*/,'майонез (Кг,гр.)'/*569*/,'аджика (сухой томат) (Л,мл.)'/*571*/,'перец черный, красный молотый (Кг,гр.)'/*572*/,'сиропы разные (Кг,гр)'/*515*/,'сиропы разные (Кг,гр)'/*515*/,'самогон (Л,мл.)'/*628*/,'копчености мясные  из свинины (Кг,гр)'/*211*/,'копчености мясные  из говядины (Кг,гр)'/*210*/,'копчености мясные из конины (Кг,гр)'/*213*/,'копчености мясные из баранины (Кг,гр)'/*212*/,'копченные окорочка (Кг,гр)'/*208*/,'колбаса ливерная, кровяная, печеночная (Кг,гр)'/*207*/,'колбаса варенная ( докторская, чайная,  (Кг,гр)'/*204*/,'колбаса варенная ( докторская, чайная,  (Кг,гр)'/*204*/,'колбаса копченная  (Кг,гр)'/*206*/,'сырокопченая колбаса (Кг,гр)'/*214*/,'карта, чучук, казы (Кг,гр)'/*203*/,'холодец (Кг,гр)'/*235*/,'гриль (Кг,гр)'/*209*/,'фарш (Кг,гр)'/*234*/,'тушенка (консервы) (Кг,гр)'/*233*/,'вяленная рыба (Кг,гр.)'/*534*/,'сельдь соленая (Кг,гр.)'/*535*/,'сельдь копченная (Кг,гр.)'/*537*/,'рыба копченая (Кг,гр.)'/*533*/,'паштет рыбный (Кг,гр.)'/*541*/,'присервы рыбные (Кг,гр.)'/*542*/,'икра осетровых рыб (Кг,гр.)'/*543*/,'икра рыбная (Кг,гр.)'/*544*/,'крабовые палочки (Кг,гр.)'/*545*/,'картофельные чипсы (Кг,гр)'/*607*/,'сок овощной (Л,мл.)'/*621*/,'сок фруктовый (Л,мл.)'/*622*/,'соки ассорти(искусственные)(л мл)'/*623*/,'салаты консервированные (Л,мл.)'/*131*/,'огурцы соленые (Кг,гр.)'/*143*/,'овощи и грибы сушеные (Кг,гр.)'/*151*/,'грибы сушенные (Кг,гр.)'/*149*/,'спаржа (Кг,гр)'/*155*/,'фасоль консервированная (Кг,гр.)'/*139*/,'горошек консервированный (Кг,гр.)'/*138*/,'помидоры соленые (Кг,гр.)'/*144*/,'томатная паста     (Кг,гр.)'/*570*/,'грибы соленные  (Кг,гр.)'/*150*/,'капуста квашеная (Кг,гр.)'/*142*/,'маслины и оливки консервированные (Кг,гр.)'/*140*/,'кукуруза консервированная (Кг,гр.)'/*141*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты консервированные с уксусом (л,мл)'/*132*/,'огурцы маринованные (Л,мл.)'/*133*/,'помидоры маринованные (Л,мл.)'/*134*/,'ассорти овощное консервированное (Л,мл.)'/*136*/,'овощи (патиссоны, кабачки) и салаты, маринованные (Л,мл.)'/*147*/,'грибы маринованные (Л,мл.)'/*135*/,'повидло, джем, варенье (Кг,гр.)'/*154*/,'бобы соевые (Кг,гр)'/*651*/,'миндаль (Кг,гр.)'/*652*/,'арахис обжаренный (соленный, обработанный) (Кг,гр.)'/*658*/,'фундук (Кг,гр.)'/*654*/,'фисташки (Кг,гр.)'/*655*/,'орех мускатный (Кг,гр.)'/*657*/,'орехи обработанные (орех лесной, грецкие орехи) (Кг,гр.)'/*659*/,'ананасы консервированные (Кг,гр.)'/*152*/,'виноград сушенный (изюм) (Кг,гр.)'/*660*/,'фрукты сушеные прочие (Кг,гр.)'/*661*/,'абрикос (курага) (Кг,гр.)'/*665*/,'чернослив (Кг,гр.)'/*662*/,'яблоки и груши (Кг,гр.)'/*663*/,'смеси сухофруктов (Кг,гр.)'/*664*/,'косточки и ядра абрикосов, персиков и слив (Кг,гр.)'/*666*/,'кокосовая стружка (Кг,гр.)'/*588*/,'фруктовые компоты (консервированные) (Л,мл.)'/*153*/,'соевое масло нерафинированное (Л,мл)'/*475*/,'оливковое масло нерафинированные (Л,мл)'/*476*/,'подсолнечное и сафлоровое масло нерафинированное (Л,мл)'/*477*/,'хлопковое масло нерафинированное (Л,мл)'/*478*/,'рапсовое, сурепное  и горчичное нерафинированное (Л,мл)'/*479*/,'рафинированное соевое масло (Л,мл)'/*481*/,'рафинированное оливковое масло (Л,мл)'/*482*/,'рафинированное подсолнечное и сафлоровое масло  (Л,мл)'/*483*/,'рафинированное хлопковое масло (Л,мл)'/*484*/,'рафинированное рапсовое, сурепное и горчичное масло (Л,мл)'/*485*/,'обрат (Л,мл.)'/*446*/,'сливки жидкие (Л,мл.)'/*431*/,'масло сливочное (Кг,гр)'/*489*/,'масло шоколадное (Кг,гр)'/*490*/,'масло топленное (Кг,гр)'/*491*/,'суюзмо (Кг,гр)'/*437*/,'творог нежирный (Кг,гр)'/*443*/,'творог жирный (Кг,гр)'/*444*/,'сыр твердые (голландский, российский тильзитский) (Кг,гр)'/*449*/,'сыр мягкий (адыгейский, сулугуни) (Кг,гр)'/*450*/,'сыры рассольные (брынза) (Кг,гр)'/*451*/,'сыр плавленый и с наполнителями (Кг,гр)'/*453*/,'сыр колбасный (Кг,гр)'/*452*/,'сгущенка (Кг,гр)'/*432*/,'айран, простокваша (Л,мл.)'/*433*/,'кефир (Л,мл.)'/*434*/,'ряженка (Л,мл.)'/*436*/,'сметана (Л,мл.)'/*435*/,'биолакт (Л,мл.)'/*438*/,'курут (Кг,гр)'/*448*/,'йогурт, фругурт (Кг,гр)'/*442*/,'пахта (Л,мл.)'/*447*/,'сыворотка (Л,мл.)'/*445*/,'тан, той-бос (Л,мл.)'/*457*/,'мороженное (Кг,гр.)'/*426*/,'рисовая сечка (Кг,гр)'/*24*/,'мука пшеничная (Кг,гр)'/*1*/,'смеси и тесто для приготовления хлебобулочных изделий (Кг,гр)'/*606*/,'крупа пшеничная (Кг,гр)'/*26*/,'манка (Кг,гр)'/*29*/,'овсянка (Кг,гр)'/*31*/,'крупа кукурузная (Кг,гр)'/*51*/,'гречка (Кг,гр)'/*33*/,'пшено (Кг,гр)'/*35*/,'ячневая  (Кг,гр)'/*37*/,'перловка (Кг,гр)'/*40*/,'крупа ячменная (Кг,гр)'/*48*/,'талкан (Кг,гр)'/*42*/,'геркулес (зерна злаков)  (Кг,гр)'/*44*/,'крупа 5-7 злаков (Кг,гр)'/*46*/,'палочки кукурузные, попкорн (Кг,гр)'/*608*/,'крахмал пшеничный (Кг,гр)'/*683*/,'крахмал  кукурузный (Кг,гр)'/*684*/,'крахмал картофельный (Кг,гр)'/*685*/,'сумолок (Кг,гр)'/*686*/,'мед искусственный (Кг,гр)'/*514*/,'кукурузное масло нерафинированное (Л,мл)'/*480*/,'рафинированное кукурузное масло (Л,мл)'/*486*/,'хлеб ржаной (Кг,гр)'/*6*/,'хлеб пшеничный белый, серый (Кг,гр)'/*7*/,'лепешки (Кг,гр)'/*8*/,'пирожное (Кг,гр)'/*62*/,'торт (Кг,гр)'/*66*/,'пироги, пирожки, пончики (Кг,гр)'/*68*/,'булочки (Кг,гр)'/*64*/,'сладости восточные (чак-чак)(Кг,гр)'/*84*/,'сухари, кириешки (Кг,гр)'/*86*/,'пряники (Кг,гр)'/*70*/,'коржики, коврижки (Кг,гр)'/*73*/,'кексы (Кг,гр)'/*88*/,'рулет (Кг,гр)'/*75*/,'печенье (Кг,гр)'/*77*/,'вафли (Кг,гр)'/*81*/,'макароны (Кг,гр)'/*11*/,'вермишель (Кг,гр)'/*13*/,'лапша (Кг,гр)'/*15*/,'рожки (Кг,гр)'/*18*/,'лагман (Кг,гр)'/*20*/,'сахар (песок, рафинад) (Кг,гр)'/*501*/,'шоколад плиточный (Кг,гр)'/*503*/,'шоколадная паста (Кг,гр)'/*516*/,'пастила, зефир (Кг,гр)'/*510*/,'мармелад (Кг,гр)'/*511*/,'халва (Кг,гр)'/*509*/,'нават (сладости восточные) (Кг,гр)'/*512*/,'финики (Кг,гр.)'/*667*/,'финики (Кг,гр.)'/*667*/,'тесто недрожжевое (Кг,гр)'/*604*/,'пельмени (Кг,гр)'/*601*/,'вареники (Кг,гр)'/*602*/,'кукси (Кг,гр)'/*603*/,'фунчеза (изделия макаронные не включенные в другие группы) (Кг,гр)'/*605*/,'вино домашнее, сидр прочие фруктовые вина (Л,мл.)'/*631*/,'бозо (Л,мл.)'/*632*/,'лимонад, кола, фанта (Л,мл.)'/*635*/,'квас (Л,мл.)'/*636*/,'максым-шоро, жарма (Л,мл.)'/*637*/,'махорка (Кг,гр)'/*640*/,'насвай (Кг,гр)'/*642*/,'помидоры маринованные (Л,мл.)'/*134*/,'сахар для диабетиков (Кг,гр)'/*502*/,'семена хлопка (для переработки на масло) (Кг,гр)'/*681*/,'семена подсолнечника (Кг,гр.)'/*682*/,'кумыс (Л,мл.)'/*456*/,'рис (Кг,гр)'/*22*/,'табак курительный (Кг,гр)'/*641*/,'рыба свежая (Кг,гр.)'/*532*/,'колбаса варенная (сосиски, сардельки) (Кг,гр)'/*205*/,'субпродукты 1 категории  (диафрагма, печень говяжья, баранья, свиная) (Кг,гр)'/*228*/,'субпродукты 2 категории (уши, губы, ножки) (Кг,гр)'/*231*/,'субпродукты 1 категории  (сердце, язык, почки, вымя, мозги) (Кг,гр)'/*229*/,'кисель, инвайт (Кг,гр.)'/*592*/]) as title
),

cte_valid_products_drugoe as (
    select unnest(array['169','186','171','178','215','221','101','113','112','55','59','53','57','115','114','127','119','118','117','120','166','174','125','111','124','110','121','122','123','103','106','109','107','108','104','105','126','102','116','187','173','161','162','161','170','182','163','168','179','176','177','205','184','427','429','531','513','216','218','217','219','220','227','223','224','201','202','230','580','175','573','582','627','225','536','540','539','538','153','428','430','439','440','441','609','79','90','92','561','504','505','687','508','507','506','634','639','638','692','167','172','164','165','180','487','488','562','563','565','564','566','577','576','578','579','591','574','581','454','455','575','586','587','583','515','226','689','690','691','624','625','626','629','630','633','584','585','589','183','185','181','232','222','546','590','567','568','569','571','572','515','515','628','211','210','213','212','208','207','204','204','206','214','203','235','209','234','233','534','535','537','533','541','542','543','544','545','607','621','622','623','131','143','151','149','155','139','138','144','570','150','142','140','141','137','137','137','132','133','134','136','147','135','154','651','652','658','654','655','657','659','152','660','661','665','662','663','664','666','588','153','475','476','477','478','479','481','482','483','484','485','446','431','489','490','491','437','443','444','449','450','451','453','452','432','433','434','436','435','438','448','442','447','445','457','426','24','1','606','26','29','31','51','33','35','37','40','48','42','44','46','608','683','684','685','686','514','480','486','6','7','8','62','66','68','64','84','86','70','73','88','75','77','81','11','13','15','18','20','501','503','516','510','511','509','512','667','667','604','601','602','603','605','631','632','635','636','637','640','642','134','502','681','682','456','22','641','532','205','228','231','229','592']) as code,
    unnest(array['виноград (Кг,гр.)'/*169*/,'хурма (Кг,гр.)'/*186*/,'гранат (Кг,гр.)'/*171*/,'лимон (Кг,гр.)'/*178*/,'куры, цыплята (Кг,гр.)'/*215*/,'мясо индейки (Кг,гр.)'/*221*/,'кукуруза (в початках) (Кг,гр.)'/*101*/,'зеленый фасоль в стручках  (Кг,гр.)'/*113*/,'зеленый горошек в стручках (Кг,гр.)'/*112*/,'фасоль (Кг,гр)'/*55*/,'чечевица сушеная (Кг, гр)'/*59*/,'горох (Кг,гр)'/*53*/,'маш (Кг,гр)'/*57*/,'капуста белокочанная (Кг,гр.)'/*115*/,'цветная капуста (Кг,гр.)'/*114*/,'салат-латук (Кг,гр.)'/*127*/,'петрушка (Кг,гр.)'/*119*/,'укроп (Кг,гр.)'/*118*/,'щавель (Кг,гр.)'/*117*/,'прочая зелень (жондо, сельдерей, жусай, райхон) (Кг,гр.)'/*120*/,'арбуз (Кг,гр.)'/*166*/,'дыня (Кг,гр.)'/*174*/,'перец свежий ( болгарский, горький) (Кг,гр.)'/*125*/,'огурцы (Кг,гр.)'/*111*/,'баклажаны (Кг,гр.)'/*124*/,'помидоры (Кг,гр.)'/*110*/,'тыква (Кг,гр.)'/*121*/,'кабачки (Кг,гр.)'/*122*/,'патиссоны (Кг,гр.)'/*123*/,'морковь (Кг,гр.)'/*103*/,'репа (Кг,гр.)'/*106*/,'чеснок (Кг,гр.)'/*109*/,'лук репчатый (Кг,гр.)'/*107*/,'лук зеленый (Кг,гр.)'/*108*/,'свекла (Кг,гр.)'/*104*/,'редька, редис (Кг,гр.)'/*105*/,'хрен (Кг,гр.)'/*126*/,'картофель (Кг,гр.)'/*102*/,'грибы свежие (Кг,гр.)'/*116*/,'яблоки (Кг,гр.)'/*187*/,'груши (Кг,гр.)'/*173*/,'абрикос (Кг,гр.)'/*161*/,'айва (Кг,гр.)'/*162*/,'абрикос (Кг,гр.)'/*161*/,'вишня, черешня (Кг,гр.)'/*170*/,'персик (Кг,гр.)'/*182*/,'алыча (Кг,гр.)'/*163*/,'барбарис (Кг,гр.)'/*168*/,'малина (Кг,гр.)'/*179*/,'клубника (Кг,гр.)'/*176*/,'крыжовник (Кг,гр.)'/*177*/,'колбаса варенная (сосиски, сардельки) (Кг,гр)'/*205*/,'смородина (Кг,гр.)'/*184*/,'молоко домашнее коровье (Л,мл.)'/*427*/,'молоко домашнее козье (Л,мл.)'/*429*/,'яйца (Шт)'/*531*/,'мед натуральный (Кг,гр)'/*513*/,'мясо говядина  (Кг,гр.)'/*216*/,'мясо свинина (Кг,гр.)'/*218*/,'мясо баранина (Кг,гр.)'/*217*/,'мясо козлятина (Кг,гр.)'/*219*/,'мясо конина (Кг,гр.)'/*220*/,'субпродукты 1 категории  (головное мясо, хвост, мясная обрез) (Кг,гр)'/*227*/,'мясо кролика (Кг,гр.)'/*223*/,'мясо нутрий (Кг,гр.)'/*224*/,'жир свиной, сало (Кг,гр.)'/*201*/,'жир скота (бараний, говяжий, овец, коз) (Кг,гр.)'/*202*/,'субпродукты 2 категории (легкие, селезенка, желудок, кишки) (Кг,гр)'/*230*/,'мак (Кг,гр.)'/*580*/,'киви, манго, папайя (Кг,гр.)'/*175*/,'черный перец горошком (Кг,гр.)'/*573*/,'соль морская (Кг,гр)'/*582*/,'бальзам (Л,мл.)'/*627*/,'окорочка куринные (Кг,гр.)'/*225*/,'сельдь в банках (Кг,гр.)'/*536*/,'рыбные консервы в собственном соку (Кг,гр.)'/*540*/,'рыбные консервы в томатном соусе (Кг,гр.)'/*539*/,'рыбные консервы в масле (Кг,гр.)'/*538*/,'фруктовые компоты (консервированные) (Л,мл.)'/*153*/,'молоко пастеризованное (Л,мл.)'/*428*/,'молоко топленое (Л,мл.)'/*430*/,'сухое молоко, сухие сливки (Кг,гр)'/*439*/,'сырки творожные нежирные (Кг,гр)'/*440*/,'сырки творожные в шоколаде, рыжий ап (Кг,гр)'/*441*/,'сухие завтраки (хлопья, колечки) (Кг,гр)'/*609*/,'шоколадно вафельный торт (Кг,гр)'/*79*/,'сушки, соломка, хлебные палочки (Кг,гр)'/*90*/,'бублики (Кг,гр)'/*92*/,'какао порошок (Кг,гр.)'/*561*/,'батончики шоколадные  (сникерс, марс) (Кг,гр)'/*504*/,'конфеты шоколадные (Кг,гр)'/*505*/,'жевательная резинка (Кг,гр)'/*687*/,'ирис (Кг,гр)'/*508*/,'леденцы (Кг,гр)'/*507*/,'конфеты карамель с начинкой (Кг,гр)'/*506*/,'минеральная вода (Л,мл.)'/*634*/,'папиросы (Шт)'/*639*/,'сигареты с фильтром (Шт)'/*638*/,'гематоген (Кг,гр)'/*692*/,'банан (Кг,гр.)'/*167*/,'грейпфруты (Кг,гр.)'/*172*/,'ананас (Кг,гр.)'/*164*/,'апельсин (Кг,гр.)'/*165*/,'мандарин (Кг,гр.)'/*180*/,'маргарин (Кг,гр)'/*487*/,'маргарин (рама, щедрое лето, иртыш) (Кг,гр)'/*488*/,'кофе в зернах (Кг,гр.)'/*562*/,'кофе растворимый (Кг,гр.)'/*563*/,'чай зеленый (Кг,гр.)'/*565*/,'чай черный (Кг,гр.)'/*564*/,'уксус (Л,мл.)'/*566*/,'корица (Кг,гр.)'/*577*/,'ванилин (Кг,гр.)'/*576*/,'гвоздика (Кг,гр.)'/*578*/,'лавровый лист (Кг,гр.)'/*579*/,'имбирь (Кг,гр.)'/*591*/,'приправы сухие (кинза, зире, кристаллики)(Кг,гр.)'/*574*/,'соль (Кг,гр)'/*581*/,'детское питание (на молочной основе) (Кг,гр)'/*454*/,'детское питание в виде смесей на гречневых, рисовых, овсяных отварах (Кг,гр)'/*455*/,'бульонные кубики, порошок (Ролтон, Маги) (Кг,гр.)'/*575*/,'дрожжи сухие (Кг,гр.)'/*586*/,'дрожжи сырые (Кг,гр.)'/*587*/,'разрыхлитель теста (Кг,гр.)'/*583*/,'сиропы разные (Кг,гр)'/*515*/,'соевое мясо, соевый сыр и фарш (Кг,гр)'/*226*/,'корм для декоративных птиц (Кг,гр)'/*689*/,'корм собакам (Кг,гр)'/*690*/,'корм кошкам (Кг,гр)'/*691*/,'коньяк (Л,мл.)'/*624*/,'водка (Л,мл.)'/*625*/,'спирт (Л,мл.)'/*626*/,'шампанское (Л,мл.)'/*629*/,'вино заводское, виноградные натуральные вина (Л,мл.)'/*630*/,'пиво (Л,мл.)'/*633*/,'сода пищевая (Кг,гр.)'/*584*/,'лимонная кислота (Кг,гр.)'/*585*/,'желатин (Кг,гр.)'/*589*/,'слива (Кг,гр.)'/*183*/,'урюк (Кг,гр.)'/*185*/,'облепиха (Кг,гр.)'/*181*/,'субпродукты птиц (Кг,гр.)'/*232*/,'мясо уток, гусей (Кг,гр.)'/*222*/,'морская капуста (Кг,гр.)'/*546*/,'соевый соус (Кг,гр.)'/*590*/,'кетчуп (Л,мл.)'/*567*/,'горчица (Кг,гр.)'/*568*/,'майонез (Кг,гр.)'/*569*/,'аджика (сухой томат) (Л,мл.)'/*571*/,'перец черный, красный молотый (Кг,гр.)'/*572*/,'сиропы разные (Кг,гр)'/*515*/,'сиропы разные (Кг,гр)'/*515*/,'самогон (Л,мл.)'/*628*/,'копчености мясные  из свинины (Кг,гр)'/*211*/,'копчености мясные  из говядины (Кг,гр)'/*210*/,'копчености мясные из конины (Кг,гр)'/*213*/,'копчености мясные из баранины (Кг,гр)'/*212*/,'копченные окорочка (Кг,гр)'/*208*/,'колбаса ливерная, кровяная, печеночная (Кг,гр)'/*207*/,'колбаса варенная ( докторская, чайная,  (Кг,гр)'/*204*/,'колбаса варенная ( докторская, чайная,  (Кг,гр)'/*204*/,'колбаса копченная  (Кг,гр)'/*206*/,'сырокопченая колбаса (Кг,гр)'/*214*/,'карта, чучук, казы (Кг,гр)'/*203*/,'холодец (Кг,гр)'/*235*/,'гриль (Кг,гр)'/*209*/,'фарш (Кг,гр)'/*234*/,'тушенка (консервы) (Кг,гр)'/*233*/,'вяленная рыба (Кг,гр.)'/*534*/,'сельдь соленая (Кг,гр.)'/*535*/,'сельдь копченная (Кг,гр.)'/*537*/,'рыба копченая (Кг,гр.)'/*533*/,'паштет рыбный (Кг,гр.)'/*541*/,'присервы рыбные (Кг,гр.)'/*542*/,'икра осетровых рыб (Кг,гр.)'/*543*/,'икра рыбная (Кг,гр.)'/*544*/,'крабовые палочки (Кг,гр.)'/*545*/,'картофельные чипсы (Кг,гр)'/*607*/,'сок овощной (Л,мл.)'/*621*/,'сок фруктовый (Л,мл.)'/*622*/,'соки ассорти(искусственные)(л мл)'/*623*/,'салаты консервированные (Л,мл.)'/*131*/,'огурцы соленые (Кг,гр.)'/*143*/,'овощи и грибы сушеные (Кг,гр.)'/*151*/,'грибы сушенные (Кг,гр.)'/*149*/,'спаржа (Кг,гр)'/*155*/,'фасоль консервированная (Кг,гр.)'/*139*/,'горошек консервированный (Кг,гр.)'/*138*/,'помидоры соленые (Кг,гр.)'/*144*/,'томатная паста     (Кг,гр.)'/*570*/,'грибы соленные  (Кг,гр.)'/*150*/,'капуста квашеная (Кг,гр.)'/*142*/,'маслины и оливки консервированные (Кг,гр.)'/*140*/,'кукуруза консервированная (Кг,гр.)'/*141*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты корейские (Кг,гр.)'/*137*/,'салаты консервированные с уксусом (л,мл)'/*132*/,'огурцы маринованные (Л,мл.)'/*133*/,'помидоры маринованные (Л,мл.)'/*134*/,'ассорти овощное консервированное (Л,мл.)'/*136*/,'овощи (патиссоны, кабачки) и салаты, маринованные (Л,мл.)'/*147*/,'грибы маринованные (Л,мл.)'/*135*/,'повидло, джем, варенье (Кг,гр.)'/*154*/,'бобы соевые (Кг,гр)'/*651*/,'миндаль (Кг,гр.)'/*652*/,'арахис обжаренный (соленный, обработанный) (Кг,гр.)'/*658*/,'фундук (Кг,гр.)'/*654*/,'фисташки (Кг,гр.)'/*655*/,'орех мускатный (Кг,гр.)'/*657*/,'орехи обработанные (орех лесной, грецкие орехи) (Кг,гр.)'/*659*/,'ананасы консервированные (Кг,гр.)'/*152*/,'виноград сушенный (изюм) (Кг,гр.)'/*660*/,'фрукты сушеные прочие (Кг,гр.)'/*661*/,'абрикос (курага) (Кг,гр.)'/*665*/,'чернослив (Кг,гр.)'/*662*/,'яблоки и груши (Кг,гр.)'/*663*/,'смеси сухофруктов (Кг,гр.)'/*664*/,'косточки и ядра абрикосов, персиков и слив (Кг,гр.)'/*666*/,'кокосовая стружка (Кг,гр.)'/*588*/,'фруктовые компоты (консервированные) (Л,мл.)'/*153*/,'соевое масло нерафинированное (Л,мл)'/*475*/,'оливковое масло нерафинированные (Л,мл)'/*476*/,'подсолнечное и сафлоровое масло нерафинированное (Л,мл)'/*477*/,'хлопковое масло нерафинированное (Л,мл)'/*478*/,'рапсовое, сурепное  и горчичное нерафинированное (Л,мл)'/*479*/,'рафинированное соевое масло (Л,мл)'/*481*/,'рафинированное оливковое масло (Л,мл)'/*482*/,'рафинированное подсолнечное и сафлоровое масло  (Л,мл)'/*483*/,'рафинированное хлопковое масло (Л,мл)'/*484*/,'рафинированное рапсовое, сурепное и горчичное масло (Л,мл)'/*485*/,'обрат (Л,мл.)'/*446*/,'сливки жидкие (Л,мл.)'/*431*/,'масло сливочное (Кг,гр)'/*489*/,'масло шоколадное (Кг,гр)'/*490*/,'масло топленное (Кг,гр)'/*491*/,'суюзмо (Кг,гр)'/*437*/,'творог нежирный (Кг,гр)'/*443*/,'творог жирный (Кг,гр)'/*444*/,'сыр твердые (голландский, российский тильзитский) (Кг,гр)'/*449*/,'сыр мягкий (адыгейский, сулугуни) (Кг,гр)'/*450*/,'сыры рассольные (брынза) (Кг,гр)'/*451*/,'сыр плавленый и с наполнителями (Кг,гр)'/*453*/,'сыр колбасный (Кг,гр)'/*452*/,'сгущенка (Кг,гр)'/*432*/,'айран, простокваша (Л,мл.)'/*433*/,'кефир (Л,мл.)'/*434*/,'ряженка (Л,мл.)'/*436*/,'сметана (Л,мл.)'/*435*/,'биолакт (Л,мл.)'/*438*/,'курут (Кг,гр)'/*448*/,'йогурт, фругурт (Кг,гр)'/*442*/,'пахта (Л,мл.)'/*447*/,'сыворотка (Л,мл.)'/*445*/,'тан, той-бос (Л,мл.)'/*457*/,'мороженное (Кг,гр.)'/*426*/,'рисовая сечка (Кг,гр)'/*24*/,'мука пшеничная (Кг,гр)'/*1*/,'смеси и тесто для приготовления хлебобулочных изделий (Кг,гр)'/*606*/,'крупа пшеничная (Кг,гр)'/*26*/,'манка (Кг,гр)'/*29*/,'овсянка (Кг,гр)'/*31*/,'крупа кукурузная (Кг,гр)'/*51*/,'гречка (Кг,гр)'/*33*/,'пшено (Кг,гр)'/*35*/,'ячневая  (Кг,гр)'/*37*/,'перловка (Кг,гр)'/*40*/,'крупа ячменная (Кг,гр)'/*48*/,'талкан (Кг,гр)'/*42*/,'геркулес (зерна злаков)  (Кг,гр)'/*44*/,'крупа 5-7 злаков (Кг,гр)'/*46*/,'палочки кукурузные, попкорн (Кг,гр)'/*608*/,'крахмал пшеничный (Кг,гр)'/*683*/,'крахмал  кукурузный (Кг,гр)'/*684*/,'крахмал картофельный (Кг,гр)'/*685*/,'сумолок (Кг,гр)'/*686*/,'мед искусственный (Кг,гр)'/*514*/,'кукурузное масло нерафинированное (Л,мл)'/*480*/,'рафинированное кукурузное масло (Л,мл)'/*486*/,'хлеб ржаной (Кг,гр)'/*6*/,'хлеб пшеничный белый, серый (Кг,гр)'/*7*/,'лепешки (Кг,гр)'/*8*/,'пирожное (Кг,гр)'/*62*/,'торт (Кг,гр)'/*66*/,'пироги, пирожки, пончики (Кг,гр)'/*68*/,'булочки (Кг,гр)'/*64*/,'сладости восточные (чак-чак)(Кг,гр)'/*84*/,'сухари, кириешки (Кг,гр)'/*86*/,'пряники (Кг,гр)'/*70*/,'коржики, коврижки (Кг,гр)'/*73*/,'кексы (Кг,гр)'/*88*/,'рулет (Кг,гр)'/*75*/,'печенье (Кг,гр)'/*77*/,'вафли (Кг,гр)'/*81*/,'макароны (Кг,гр)'/*11*/,'вермишель (Кг,гр)'/*13*/,'лапша (Кг,гр)'/*15*/,'рожки (Кг,гр)'/*18*/,'лагман (Кг,гр)'/*20*/,'сахар (песок, рафинад) (Кг,гр)'/*501*/,'шоколад плиточный (Кг,гр)'/*503*/,'шоколадная паста (Кг,гр)'/*516*/,'пастила, зефир (Кг,гр)'/*510*/,'мармелад (Кг,гр)'/*511*/,'халва (Кг,гр)'/*509*/,'нават (сладости восточные) (Кг,гр)'/*512*/,'финики (Кг,гр.)'/*667*/,'финики (Кг,гр.)'/*667*/,'тесто недрожжевое (Кг,гр)'/*604*/,'пельмени (Кг,гр)'/*601*/,'вареники (Кг,гр)'/*602*/,'кукси (Кг,гр)'/*603*/,'фунчеза (изделия макаронные не включенные в другие группы) (Кг,гр)'/*605*/,'вино домашнее, сидр прочие фруктовые вина (Л,мл.)'/*631*/,'бозо (Л,мл.)'/*632*/,'лимонад, кола, фанта (Л,мл.)'/*635*/,'квас (Л,мл.)'/*636*/,'максым-шоро, жарма (Л,мл.)'/*637*/,'махорка (Кг,гр)'/*640*/,'насвай (Кг,гр)'/*642*/,'помидоры маринованные (Л,мл.)'/*134*/,'сахар для диабетиков (Кг,гр)'/*502*/,'семена хлопка (для переработки на масло) (Кг,гр)'/*681*/,'семена подсолнечника (Кг,гр.)'/*682*/,'кумыс (Л,мл.)'/*456*/,'рис (Кг,гр)'/*22*/,'табак курительный (Кг,гр)'/*641*/,'рыба свежая (Кг,гр.)'/*532*/,'колбаса варенная (сосиски, сардельки) (Кг,гр)'/*205*/,'субпродукты 1 категории  (диафрагма, печень говяжья, баранья, свиная) (Кг,гр)'/*228*/,'субпродукты 2 категории (уши, губы, ножки) (Кг,гр)'/*231*/,'субпродукты 1 категории  (сердце, язык, почки, вымя, мозги) (Кг,гр)'/*229*/,'кисель, инвайт (Кг,гр.)'/*592*/]) as title
),

cte_valid_products_ohota as (
    select unnest(array['183','185','181','232','222','532']) as code,
    unnest(array['слива (Кг,гр.)'/*183*/,'урюк (Кг,гр.)'/*185*/,'облепиха (Кг,гр.)'/*181*/,'субпродукты птиц (Кг,гр.)'/*232*/,'мясо уток, гусей (Кг,гр.)'/*222*/,'рыба свежая (Кг,гр.)'/*532*/]) as title
)

(select summary.summaryid as InterviewId
    ,summary.key as InterviewKey
    ,summary.questionnairetitle as QuestionnaireTitle
    ,summary.updatedate as InterviewDate
    ,summary.teamleadname as Region
    ,q_entity.stata_export_caption as QuestionCode
    ,interview.asint as ProductSupplySource
    ,'Форма 3' as Form
    ,'Раздел 2' as Section
    ,'Вопрос 1' as QuestionNumber
    ,'Потребление продуктов питания, напитков и табачных изделий' as QuestionText
    ,coalesce(
        (select title from cte_all_products where code::text = interview.rostervector),
        'код продукта не найден в справочнике'
        ) as InfoMessage
from readside.interviews as interview
    join readside.questionnaire_entities as q_entity
        on interview.entityid = q_entity.id
    join readside.interviews_id as interview_id
        on interview.interviewid = interview_id.id
    join readside.interviewsummaries as summary
        on interview_id.interviewid = summary.interviewid
where q_entity.stata_export_caption like 'f3r2q6b%'
    and interview.asint = '1'
    and interview.rostervector not in (select code::text from cte_valid_products_lph)
order by summary.summaryid)

union all

(select summary.summaryid as InterviewId
    ,summary.key as InterviewKey
    ,summary.questionnairetitle as QuestionnaireTitle
    ,summary.updatedate as InterviewDate
    ,summary.teamleadname as Region
    ,q_entity.stata_export_caption as QuestionCode
    ,interview.asint as ProductSupplySource
    ,'Форма 3' as Form
    ,'Раздел 2' as Section
    ,'Вопрос 1' as QuestionNumber
    ,'Потребление продуктов питания, напитков и табачных изделий' as QuestionText
    ,coalesce(
        (select title from cte_all_products where code::text = interview.rostervector),
        'код продукта не найден в справочнике'
        ) as InfoMessage
from readside.interviews as interview
    join readside.questionnaire_entities as q_entity
        on interview.entityid = q_entity.id
    join readside.interviews_id as interview_id
        on interview.interviewid = interview_id.id
    join readside.interviewsummaries as summary
        on interview_id.interviewid = summary.interviewid
where q_entity.stata_export_caption like 'f3r2q6b%'
    and interview.asint = '2'
    and interview.rostervector not in (select code::text from cte_valid_products_kuplen)
order by summary.summaryid)

union all

(select summary.summaryid as InterviewId
    ,summary.key as InterviewKey
    ,summary.questionnairetitle as QuestionnaireTitle
    ,summary.updatedate as InterviewDate
    ,summary.teamleadname as Region
    ,q_entity.stata_export_caption as QuestionCode
    ,interview.asint as ProductSupplySource
    ,'Форма 3' as Form
    ,'Раздел 2' as Section
    ,'Вопрос 1' as QuestionNumber
    ,'Потребление продуктов питания, напитков и табачных изделий' as QuestionText
    ,coalesce(
        (select title from cte_all_products where code::text = interview.rostervector),
        'код продукта не найден в справочнике'
        ) as InfoMessage
from readside.interviews as interview
    join readside.questionnaire_entities as q_entity
        on interview.entityid = q_entity.id
    join readside.interviews_id as interview_id
        on interview.interviewid = interview_id.id
    join readside.interviewsummaries as summary
        on interview_id.interviewid = summary.interviewid
where q_entity.stata_export_caption like 'f3r2q6b%'
    and interview.asint = '3'
    and interview.rostervector not in (select code::text from cte_valid_products_vpodarok)
order by summary.summaryid)

union all

(select summary.summaryid as InterviewId
    ,summary.key as InterviewKey
    ,summary.questionnairetitle as QuestionnaireTitle
    ,summary.updatedate as InterviewDate
    ,summary.teamleadname as Region
    ,q_entity.stata_export_caption as QuestionCode
    ,interview.asint as ProductSupplySource
    ,'Форма 3' as Form
    ,'Раздел 2' as Section
    ,'Вопрос 1' as QuestionNumber
    ,'Потребление продуктов питания, напитков и табачных изделий' as QuestionText
    ,coalesce(
        (select title from cte_all_products where code::text = interview.rostervector),
        'код продукта не найден в справочнике'
        ) as InfoMessage
from readside.interviews as interview
    join readside.questionnaire_entities as q_entity
        on interview.entityid = q_entity.id
    join readside.interviews_id as interview_id
        on interview.interviewid = interview_id.id
    join readside.interviewsummaries as summary
        on interview_id.interviewid = summary.interviewid
where q_entity.stata_export_caption like 'f3r2q6b%'
    and interview.asint = '4'
    and interview.rostervector not in (select code::text from cte_valid_products_pererabotka)
order by summary.summaryid)

union all

(select summary.summaryid as InterviewId
    ,summary.key as InterviewKey
    ,summary.questionnairetitle as QuestionnaireTitle
    ,summary.updatedate as InterviewDate
    ,summary.teamleadname as Region
    ,q_entity.stata_export_caption as QuestionCode
    ,interview.asint as ProductSupplySource
    ,'Форма 3' as Form
    ,'Раздел 2' as Section
    ,'Вопрос 1' as QuestionNumber
    ,'Потребление продуктов питания, напитков и табачных изделий' as QuestionText
    ,coalesce(
        (select title from cte_all_products where code::text = interview.rostervector),
        'код продукта не найден в справочнике'
        ) as InfoMessage
from readside.interviews as interview
    join readside.questionnaire_entities as q_entity
        on interview.entityid = q_entity.id
    join readside.interviews_id as interview_id
        on interview.interviewid = interview_id.id
    join readside.interviewsummaries as summary
        on interview_id.interviewid = summary.interviewid
where q_entity.stata_export_caption like 'f3r2q6b%'
    and interview.asint = '5'
    and interview.rostervector not in (select code::text from cte_valid_products_natura)
order by summary.summaryid)

union all

(select summary.summaryid as InterviewId
    ,summary.key as InterviewKey
    ,summary.questionnairetitle as QuestionnaireTitle
    ,summary.updatedate as InterviewDate
    ,summary.teamleadname as Region
    ,q_entity.stata_export_caption as QuestionCode
    ,interview.asint as ProductSupplySource
    ,'Форма 3' as Form
    ,'Раздел 2' as Section
    ,'Вопрос 1' as QuestionNumber
    ,'Потребление продуктов питания, напитков и табачных изделий' as QuestionText
    ,coalesce(
        (select title from cte_all_products where code::text = interview.rostervector),
        'код продукта не найден в справочнике'
        ) as InfoMessage
from readside.interviews as interview
    join readside.questionnaire_entities as q_entity
        on interview.entityid = q_entity.id
    join readside.interviews_id as interview_id
        on interview.interviewid = interview_id.id
    join readside.interviewsummaries as summary
        on interview_id.interviewid = summary.interviewid
where q_entity.stata_export_caption like 'f3r2q6b%'
    and interview.asint = '6'
    and interview.rostervector not in (select code::text from cte_valid_products_drugoe)
order by summary.summaryid)

union all

(select summary.summaryid as InterviewId
    ,summary.key as InterviewKey
    ,summary.questionnairetitle as QuestionnaireTitle
    ,summary.updatedate as InterviewDate
    ,summary.teamleadname as Region
    ,q_entity.stata_export_caption as QuestionCode
    ,interview.asint as ProductSupplySource
    ,'Форма 3' as Form
    ,'Раздел 2' as Section
    ,'Вопрос 1' as QuestionNumber
    ,'Потребление продуктов питания, напитков и табачных изделий' as QuestionText
    ,coalesce(
        (select title from cte_all_products where code::text = interview.rostervector),
        'код продукта не найден в справочнике'
        ) as InfoMessage
from readside.interviews as interview
    join readside.questionnaire_entities as q_entity
        on interview.entityid = q_entity.id
    join readside.interviews_id as interview_id
        on interview.interviewid = interview_id.id
    join readside.interviewsummaries as summary
        on interview_id.interviewid = summary.interviewid
where q_entity.stata_export_caption like 'f3r2q6b%'
    and interview.asint = '7'
    and interview.rostervector not in (select code::text from cte_valid_products_ohota)
order by summary.summaryid)";
    }
}
